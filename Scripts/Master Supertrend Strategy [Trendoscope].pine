Script Name: Master Supertrend Strategy [Trendoscope]
Author: Trendoscope
Description: Here is the strategy version of the indicator -  Master Supertrend 

Options and variations are same throughout.

 ğŸ² Variations 
Following variations are provided in the form of settings.

 ğŸ¯ Range Type 
Instead of ATR, different types of ranges can be used for stop calculation. Here is the complete list used in the script.

 Plus/Minus Range*  - Calculates plus...
PineScript code:

Pine Scriptâ„¢ strategy
Master Supertrend Strategy [Trendoscope]
Copy code
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
//Â ThisÂ workÂ isÂ licensedÂ underÂ CreativeÂ CommonsÂ Attribution-NonCommercial-ShareAlikeÂ 4.0Â InternationalÂ LicenseÂ (CCÂ BY-NC-SAÂ 4.0)Â https://creativecommons.org/licenses/by-nc-sa/4.0/
//Â Â©Â TrendoscopeÂ PtyÂ Ltd
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–‘â–’Â Â Â Â Â Â Â Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’Â Â Â â–’â–’Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’Â Â Â Â Â â–’â–’Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’â–’â–’â–‘Â Â Â Â Â â–’Â Â Â Â Â â–’â–’Â Â Â Â Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â Â Â â–’Â Â Â Â Â â–’â–’Â Â Â Â Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â â–“â–’â–’â–’Â Â Â Â Â Â Â â–’Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’Â Â 
//Â Â Â â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’Â â–’Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â 
//Â Â Â â–’Â Â â–’Â Â Â Â Â Â Â â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–‘Â Â Â Â Â Â Â Â 
//Â Â Â â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–‘â–’â–’â–’â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â 
//Â Â Â â–“â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’Â â–’â–’Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
//Â Â Â Â â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’Â â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–‘â–’â–’â–’â–’Â Â Â â–’â–’â–’â–’â–“Â Â Â Â Â Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—Â Â Â â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–“â–’â–’â–’â–’Â Â Â Â Â â–’â–’â–’â–’Â Â Â Â Â Â â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•
//Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â Â â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘Â Â Â Â Â â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â 
//Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’Â Â Â Â Â Â Â â–’â–’â–’â–’â–’Â Â Â Â Â Â Â â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•Â Â â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â Â Â Â â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•Â â–ˆâ–ˆâ•”â•â•â•Â Â 
//Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’Â Â Â Â Â Â Â Â Â â–’â–’â–’â–’â–’Â Â Â Â Â Â â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘Â â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘Â Â Â Â Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
//Â Â Â Â Â Â Â Â Â Â Â Â Â â–’â–’Â Â Â Â Â Â Â Â Â Â Â Â Â â–’Â Â Â 
//
//@version=5
//Â indicator("MasterÂ SupertrendÂ [Trendoscope]",Â "MSTÂ [Trendoscope]",Â overlayÂ =Â true)
strategy("MasterÂ SupertrendÂ StrategyÂ [Trendoscope]",Â "MSTSÂ [Trendoscope]",Â overlay=true,Â initial_capital=1000,
Â Â Â Â Â Â Â Â Â default_qty_type=strategy.percent_of_equity,Â default_qty_value=10,Â commission_type=strategy.commission.percent,Â 
Â Â Â Â Â Â Â Â Â pyramiding=1,Â commission_value=0.05,Â close_entries_rule="ANY",Â margin_long=100,Â margin_short=100,
Â Â Â Â Â Â Â Â Â max_lines_count=500,Â max_labels_count=500,Â max_boxes_count=500,Â use_bar_magnifier=false)
importÂ HeWhoMustNotBeNamed/ta/1Â asÂ etaâ€Šloading...
importÂ HeWhoMustNotBeNamed/arrayutils/22Â asÂ paâ€Šloading...
supertrendTypeÂ =Â input.string('Plus/MinusÂ Range',Â 'RangeÂ Type',Â ['Plus/MinusÂ Range',Â 'LadderÂ TR',Â 'TrueÂ Range',Â 'StandardÂ Deviation'],Â 'TypeÂ ofÂ rangeÂ usedÂ forÂ supertrendÂ calculation')
rangeTypeÂ =Â input.string('high',Â 'AppliedÂ Calculation',Â ['sma',Â 'ema',Â 'hma',Â 'rma',Â 'wma',Â 'high',Â 'median'],Â 'AppliedÂ calculationÂ methodÂ onÂ theÂ rangeÂ beforeÂ usingÂ themÂ forÂ calculationÂ ofÂ supertrendÂ stops')
lengthÂ =Â input.int(60,Â 'Length',Â 10,Â 1000,Â 10,Â tooltipÂ =Â 'SupertrendÂ rangeÂ calculationÂ length')
multiplierÂ =Â input.int(2,Â 'Multiplier',Â 2,Â 100,Â 1,Â tooltip='SupertrendÂ rangeÂ multiplier')
useClosePricesÂ =Â input.bool(true,Â 'UseÂ CloseÂ Price',Â tooltipÂ =Â 'UseÂ closeÂ priceÂ asÂ referenceÂ instadÂ ofÂ high/lowÂ forÂ calculationÂ ofÂ stop')
waitForCloseÂ =Â input.bool(true,Â 'WaitÂ forÂ Close',Â tooltipÂ =Â 'WaitÂ forÂ closeÂ beforeÂ changingÂ theÂ directionÂ andÂ changeÂ directionÂ onlyÂ ifÂ closeÂ priceÂ hasÂ breachedÂ theÂ stopÂ line')
useDiminishingRangeÂ =Â input.bool(true,Â 'DiminishingÂ StopÂ Distance',Â tooltipÂ =Â 'WhenÂ selectedÂ stopÂ distanceÂ fromÂ referenceÂ priceÂ canÂ onlyÂ decreaseÂ andÂ notÂ increase')
floatÂ ladderPositiveAtrÂ =Â na
floatÂ ladderNegativeAtrÂ =Â na
if(supertrendTypeÂ ==Â 'LadderÂ TR')
Â Â Â Â varÂ plusLadderAtrÂ =Â array.new<float>()
Â Â Â Â varÂ minusLadderAtrÂ =Â array.new<float>()
Â Â Â Â if(openÂ <Â close)
Â Â Â Â Â Â Â Â pa.push(plusLadderAtr,Â ta.tr,Â length)
Â Â Â Â else
Â Â Â Â Â Â Â Â pa.push(minusLadderAtr,Â ta.tr,Â length)
Â Â Â Â ladderPositiveAtrÂ :=Â pa.ma(plusLadderAtr,Â rangeType,Â length)
Â Â Â Â ladderNegativeAtrÂ :=Â pa.ma(minusLadderAtr,Â rangeType,Â length)
plusRangeÂ =Â supertrendTypeÂ ==Â 'Plus/MinusÂ Range'Â ?Â math.max(high-open,Â high-close[1])Â :Â supertrendTypeÂ ==Â 'LadderÂ TR'?Â ladderPositiveAtrÂ :Â supertrendTypeÂ ==Â 'TrueÂ Range'Â ?Â ta.trÂ :Â ta.stdev(close,Â length,Â true)
minusRangeÂ =Â supertrendTypeÂ ==Â 'Plus/MinusÂ Range'Â ?Â math.max(open-low,Â close[1]-low)Â :Â supertrendTypeÂ ==Â 'LadderÂ TR'?Â ladderNegativeAtrÂ :Â supertrendTypeÂ ==Â 'TrueÂ Range'Â ?Â ta.trÂ :Â ta.stdev(close,Â length,Â true)
appliedPlusRangeÂ =Â supertrendTypeÂ ==Â 'LadderÂ TR'?Â plusRangeÂ :Â eta.ma(plusRange,Â rangeType,Â length)
appliedMinusRangeÂ =Â supertrendTypeÂ ==Â 'LadderÂ TR'?Â minusRange:Â eta.ma(minusRange,Â rangeType,Â length)
varÂ directionÂ =Â 1
varÂ derivedPlusRangeÂ =Â appliedPlusRange*multiplier
varÂ derivedMinusRangeÂ =Â appliedMinusRange*multiplier
currentDerivedPlusRangeÂ =Â appliedPlusRange*multiplier
derivedPlusRangeÂ :=Â directionÂ <Â 0Â andÂ useDiminishingRange?Â math.min(nz(derivedPlusRange,currentDerivedPlusRange),Â currentDerivedPlusRange)Â :Â currentDerivedPlusRange
currentDerivedMinusRangeÂ =Â appliedMinusRange*multiplier
derivedMinusRangeÂ :=Â directionÂ >Â 0Â andÂ useDiminishingRange?Â math.min(nz(derivedMinusRange,currentDerivedMinusRange),Â currentDerivedMinusRange)Â :Â currentDerivedMinusRange
buyStopCurrentÂ =Â (useClosePrices?Â closeÂ :Â low)Â -Â derivedMinusRange
varÂ buyStopÂ =Â buyStopCurrent
sellStopCurrentÂ =Â (useClosePrices?Â closeÂ :Â high)Â +Â derivedPlusRange
varÂ sellStopÂ =Â sellStopCurrent
buyStop:=Â directionÂ >Â 0?Â math.max(nz(buyStop,Â buyStopCurrent),Â buyStopCurrent)Â :Â buyStopCurrent
sellStop:=directionÂ <Â 0?Â math.min(nz(sellStop,Â sellStopCurrent),Â sellStopCurrent)Â :Â sellStopCurrent
directionÂ :=Â directionÂ >Â 0Â andÂ (waitForClose?close:low)Â <Â buyStop?Â -1Â :
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â directionÂ <Â 0Â andÂ (waitForClose?close:high)Â >Â sellStop?Â 1Â :Â direction
supertrendÂ =Â direction[1]Â >Â 0?Â buyStopÂ :Â sellStop
plot(supertrend,Â 'Supertrend',Â direction[1]>0?Â color.red:color.green)
plot(direction,Â "direction",Â displayÂ =Â display.data_window)
plot(strategy.equity,Â "Equity",Â displayÂ =Â display.data_window)
plot(strategy.openprofit,Â "OpenÂ Profit",Â displayÂ =Â display.data_window)
plot(strategy.opentrades,Â "OpenÂ Trades",Â displayÂ =Â display.data_window)
if(directionÂ >Â 0)
Â Â Â Â strategy.entry("Long",Â strategy.long)
if(directionÂ <Â 0)
Â Â Â Â strategy.entry("Short",Â strategy.short)
Expand (93 lines)