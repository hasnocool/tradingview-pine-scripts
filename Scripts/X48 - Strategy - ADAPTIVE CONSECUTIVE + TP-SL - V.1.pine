Script Name: X48 - Strategy - ADAPTIVE CONSECUTIVE + TP-SL - V.1
Author: X4815162342
Description: Thanks For Tradingview Built-in Script :: << Original From Consecutive Strategy Built-in Script >> 

 ================== Read This First Before Use This Strategy ============== 
 
  Please be aware that this strategy is not a guarantee of success and may lead to losses.
  Trading involves risk and you should always do your own research before making any...
PineScript code:

Pine Scriptâ„¢ strategy
X48 - Strategy | ADAPTIVE CONSECUTIVE + TP/SL | V.1
Copy code
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
//ThanksÂ ForÂ TradingviewÂ Built-inÂ ScriptÂ ::Â <<Â OriginalÂ FromÂ ConsecutiveÂ StrategyÂ Built-inÂ ScriptÂ >>
//ThisÂ StrategyÂ ModÂ byÂ MEÂ :Â X4815162342
//==================Â ReadÂ ThisÂ FirstÂ BeforeÂ UseÂ ThisÂ StrategyÂ ==============
//Â ***********Â PleaseÂ beÂ awareÂ thatÂ thisÂ strategyÂ isÂ notÂ aÂ guaranteeÂ ofÂ successÂ andÂ mayÂ leadÂ toÂ losses.
//Â ***********Â TradingÂ involvesÂ riskÂ andÂ youÂ shouldÂ alwaysÂ doÂ yourÂ ownÂ researchÂ beforeÂ makingÂ anyÂ decisions.
//Â ***********Â ThisÂ StrategyÂ JustÂ anÂ IdeaÂ ForÂ HelpÂ YourÂ DecisionÂ ForÂ OpenPosition.
//Â ***********Â YouÂ MustÂ BeÂ SearchÂ andÂ MakeÂ YourÂ SelfÂ UnderstandÂ WhatÂ YouÂ DoingÂ InÂ ThisÂ Strategy.
//Â ***********Â ExampleÂ ::Â ThisÂ StrategyÂ andÂ IndicatorÂ FindÂ TheÂ ConsecutiveÂ BarsÂ AndÂ You,Â YouÂ AreÂ ReadingÂ MustÂ BeÂ DecisionÂ UpÂ toÂ YouÂ !!
//Â ***********Â ForÂ BacktestÂ ShowÂ It'sÂ ThatÂ ForÂ aÂ NewbieÂ 100$Â PortfolioÂ andÂ 16.333$Â PerÂ OrderÂ Size
//>>>>Â ReadÂ MeÂ FirstÂ !!Â <<<<<Â 
//==========Â DetailedÂ andÂ meaningfulÂ descriptionÂ =========
//Â -Â HowÂ It'sÂ WorkÂ :Â ThisÂ StrategyÂ areÂ FollowingÂ [Length]GreenÂ orÂ [Length]RedÂ CandleÂ ::Â exampleÂ 3Â GreenÂ CandleÂ ToÂ OpenLongÂ Position
//Â -Â CanÂ SetÂ TP/SLÂ ifÂ youÂ wantÂ ::Â JustÂ FineÂ TheÂ BestÂ ValueÂ ofÂ AssetÂ asÂ youÂ want
//Â -Â FastÂ TrendÂ =Â MAÂ FASTÂ LINEÂ [BlueÂ Line]
//Â -Â SLOWÂ TrendÂ =Â MAÂ SLOWÂ LINEÂ [RedÂ Line]
//Â -Â MID-TERMÂ TRENDÂ =Â MAÂ MID-TERMÂ [YellowÂ Line]
//Â -Â LONG-TERMÂ TRENDÂ =Â MAÂ LONG-TERMÂ [WhiteÂ Line]
//===========Â ConditionÂ AndÂ StatementÂ ===========
//Â LongÂ ConditionÂ StatementÂ ::Â [Length]Â CandlesÂ ConsecutiveÂ BarsÂ UpÂ andÂ closeÂ >Â golden_lineÂ andÂ fast_lineÂ >Â golden_line
//Â ShortÂ ConditionÂ StatementÂ ::Â [Length]Â CandlesÂ ConsecutiveÂ BarsÂ DownÂ andÂ closeÂ <Â golden_lineÂ andÂ fast_lineÂ <Â golden_line
//Â AutoCloseLongÂ ConditionÂ ::Â [Length]Â CandlesÂ ConsecutiveBarsDownStopÂ andÂ closeÂ >Â golden_lineÂ andÂ close[2]Â <Â death_lineÂ andÂ close[1]Â <Â death_lineÂ andÂ closeÂ <Â death_lineÂ orÂ fastUpdeath
//Â AutoCloseShortÂ ConditionÂ ::Â [Length]Â CandlesÂ ConsecutiveBarsUpStopÂ andÂ closeÂ <Â golden_lineÂ andÂ close[2]Â >Â death_lineÂ andÂ close[1]Â >Â death_lineÂ andÂ closeÂ >Â death_lineÂ orÂ fastUpdeath
//Â ======Â ForÂ ADAPTIVEÂ youÂ canÂ customizeÂ yourÂ ALLÂ MAÂ [FAST,Â SLOW,Â MID-TERM,Â LONG-TERM]Â ForÂ YourÂ Statement
///////////ForÂ ExampleÂ HookÂ AlertÂ CommandÂ ////////////
//Â JustÂ EasyÂ CommandÂ >>Â ::Â {{strategy.order.alert_message}}
//Â OrÂ OtherÂ JsonÂ YouÂ ShouldÂ EditÂ CommandÂ LikeÂ ThisÂ Example
//Â {"ex":"'bnfuture'","side":Â "AutoLong",Â "$16.333",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "1234","leverage":"10",Â "tp"Â :Â "5",Â "sl"Â :Â "2",Â "tl"Â :Â "2",Â "callback"Â :Â "1"}Â //
//Â {"ex":"'bnfuture'","side":Â "AutoShort",Â "$16.333",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "1234","leverage":"10",Â "tp"Â :Â "5",Â "sl"Â :Â "2",Â "tl"Â :Â "2",Â "callback"Â :Â "1"}Â //
//////////////////////////////////////////////////////
//@version=5
strategy("X48Â -Â StrategyÂ |Â ADAPTIVEÂ CONSECUTIVEÂ +Â TP/SLÂ |Â V.1",Â overlay=true,Â default_qty_typeÂ =Â strategy.cash,Â default_qty_valueÂ =Â 16.333,Â currencyÂ =Â currency.USD,Â initial_capitalÂ =Â 100,Â commission_typeÂ =Â strategy.commission.percent,Â commission_valueÂ =Â 0.1)
//================Â SPOTÂ MODEÂ ==============
GRSPTÂ =Â "===Â ğŸ€ğŸ€ğŸ€Â SPOTÂ MODEÂ ğŸ€ğŸ€ğŸ€Â ==="
Spot_MODEÂ =Â input.bool(defvalÂ =Â false,Â titleÂ =Â "ğŸ€Â SPOTÂ MODE",Â groupÂ =Â GRSPT)
Auto_StopÂ =Â input.bool(defvalÂ =Â true,Â titleÂ =Â "ğŸµÂ AUTOÂ TP/SL",Â groupÂ =Â "CONSECUTIVE-SETTING")
consecutiveBarsUpÂ =Â input(defvalÂ =Â 3,Â titleÂ =Â "BarsUp-Length",Â groupÂ =Â "CONSECUTIVE-SETTING")
consecutiveBarsDownÂ =Â input(defvalÂ =Â 3,Â titleÂ =Â "BarsDown-Length",Â groupÂ =Â "CONSECUTIVE-SETTING")
consecutiveBarsUpStopÂ =Â input(defvalÂ =Â 2,Â titleÂ =Â "BarsStopUp-Length",Â groupÂ =Â "CONSECUTIVE-STOP")
consecutiveBarsDownStopÂ =Â input(defvalÂ =Â 2,Â titleÂ =Â "BarsStopDown-Length",Â groupÂ =Â "CONSECUTIVE-STOP")
////////////////////////////////////////////////////////////////////////////////////
GRMACÂ =Â '===ğŸ’¯ğŸ’¯ğŸ’¯4ï¸âƒ£Â MultiÂ MAÂ SETTINGÂ 4ï¸âƒ£ğŸ’¯ğŸ’¯ğŸ’¯==='
///////////Â NormalÂ SettingÂ ////////////////
srcstrategyÂ =Â input(close,Â title='ğŸ’¯4ï¸âƒ£Â SourceÂ MultiÂ MA',Â groupÂ =Â GRMAC,Â tooltipÂ =Â 'NormalÂ LineÂ =Â CloseÂ \nSmoothÂ LineÂ =Â ohlc4')
/////////////Â EMA/SMAÂ SETTINGÂ /////////////
pricestrategyÂ =Â request.security(syminfo.tickerid,Â timeframe.period,Â srcstrategy)
ma1strategyÂ =Â input(8,Â title='ğŸ’¯4ï¸âƒ£Â FastÂ MAÂ Length',Â groupÂ =Â GRMAC,Â inlineÂ =Â '12')
type1strategyÂ =Â input.string('EMA',Â 'FastÂ MAÂ Type',Â options=['SMA',Â 'EMA',Â 'WMA',Â 'HMA',Â 'RMA',Â 'VWMA'],Â groupÂ =Â GRMAC,Â tooltipÂ =Â 'SMAÂ /Â EMAÂ /Â WMAÂ /Â HMAÂ /Â RMAÂ /Â VWMA',Â inlineÂ =Â '12')
ma3strategyÂ =Â input(32,Â title='ğŸ’¯4ï¸âƒ£Â SlowÂ MAÂ Length',Â groupÂ =Â GRMAC,Â inlineÂ =Â '13')
type3strategyÂ =Â input.string('EMA',Â 'SlowÂ MAÂ Type',Â options=['SMA',Â 'EMA',Â 'WMA',Â 'HMA',Â 'RMA',Â 'VWMA'],Â groupÂ =Â GRMAC,Â tooltipÂ =Â 'SMAÂ /Â EMAÂ /Â WMAÂ /Â HMAÂ /Â RMAÂ /Â VWMA',Â inlineÂ =Â '13')
ma4strategyÂ =Â input(50,Â title='ğŸ’¯4ï¸âƒ£Â MidÂ MAÂ Length',Â groupÂ =Â GRMAC,Â inlineÂ =Â '14')
type4strategyÂ =Â input.string('EMA',Â 'MidÂ MAÂ Type',Â options=['SMA',Â 'EMA',Â 'WMA',Â 'HMA',Â 'RMA',Â 'VWMA'],Â groupÂ =Â GRMAC,Â tooltipÂ =Â 'SMAÂ /Â EMAÂ /Â WMAÂ /Â HMAÂ /Â RMAÂ /Â VWMA',Â inlineÂ =Â '14')
ma5strategyÂ =Â input(200,Â title='ğŸ’¯4ï¸âƒ£Â LongÂ MAÂ Length',Â groupÂ =Â GRMAC,Â inlineÂ =Â '15')
type5strategyÂ =Â input.string('EMA',Â 'LongÂ MAÂ Type',Â options=['SMA',Â 'EMA',Â 'WMA',Â 'HMA',Â 'RMA',Â 'VWMA'],Â groupÂ =Â GRMAC,Â tooltipÂ =Â 'SMAÂ /Â EMAÂ /Â WMAÂ /Â HMAÂ /Â RMAÂ /Â VWMA',Â inlineÂ =Â '15')
price1strategyÂ =Â switchÂ type1strategy
Â Â Â Â "EMA"Â =>Â ta.ema(pricestrategy,Â ma1strategy)
Â Â Â Â "SMA"Â =>Â ta.sma(pricestrategy,Â ma1strategy)
Â Â Â Â "WMA"Â =>Â ta.wma(pricestrategy,Â ma1strategy)
Â Â Â Â "HMA"Â =>Â ta.hma(pricestrategy,Â ma1strategy)
Â Â Â Â "RMA"Â =>Â ta.rma(pricestrategy,Â ma1strategy)
Â Â Â Â "VWMA"Â =>Â ta.vwma(pricestrategy,Â ma1strategy)
Â Â Â Â Â Â Â Â 
price3strategyÂ =Â switchÂ type3strategy
Â Â Â Â "EMA"Â =>Â ta.ema(pricestrategy,Â ma3strategy)
Â Â Â Â "SMA"Â =>Â ta.sma(pricestrategy,Â ma3strategy)
Â Â Â Â "WMA"Â =>Â ta.wma(pricestrategy,Â ma3strategy)
Â Â Â Â "HMA"Â =>Â ta.hma(pricestrategy,Â ma3strategy)
Â Â Â Â "RMA"Â =>Â ta.rma(pricestrategy,Â ma3strategy)
Â Â Â Â "VWMA"Â =>Â ta.vwma(pricestrategy,Â ma3strategy)
price4strategyÂ =Â switchÂ type4strategy
Â Â Â Â "EMA"Â =>Â ta.ema(pricestrategy,Â ma4strategy)
Â Â Â Â "SMA"Â =>Â ta.sma(pricestrategy,Â ma4strategy)
Â Â Â Â "WMA"Â =>Â ta.wma(pricestrategy,Â ma4strategy)
Â Â Â Â "HMA"Â =>Â ta.hma(pricestrategy,Â ma4strategy)
Â Â Â Â "RMA"Â =>Â ta.rma(pricestrategy,Â ma4strategy)
Â Â Â Â "VWMA"Â =>Â ta.vwma(pricestrategy,Â ma4strategy)
price5strategyÂ =Â switchÂ type5strategy
Â Â Â Â "EMA"Â =>Â ta.ema(pricestrategy,Â ma5strategy)
Â Â Â Â "SMA"Â =>Â ta.sma(pricestrategy,Â ma5strategy)
Â Â Â Â "WMA"Â =>Â ta.wma(pricestrategy,Â ma5strategy)
Â Â Â Â "HMA"Â =>Â ta.hma(pricestrategy,Â ma5strategy)
Â Â Â Â "RMA"Â =>Â ta.rma(pricestrategy,Â ma5strategy)
Â Â Â Â "VWMA"Â =>Â ta.vwma(pricestrategy,Â ma5strategy)
fast_plotÂ =Â input.bool(defvalÂ =Â true,Â titleÂ =Â "MAÂ FAST",Â groupÂ =Â "PLOT",Â inlineÂ =Â "P1")
slow_plotÂ =Â input.bool(defvalÂ =Â true,Â titleÂ =Â "MAÂ SLOW",Â groupÂ =Â "PLOT",Â inlineÂ =Â "P1")
death_plotÂ =Â input.bool(defvalÂ =Â true,Â titleÂ =Â "MIDÂ MA",Â groupÂ =Â "PLOT",Â inlineÂ =Â "P2")
golden_plotÂ =Â input.bool(defvalÂ =Â true,Â titleÂ =Â "LONGÂ MA",Â groupÂ =Â "PLOT",Â inlineÂ =Â "P2")
priceÂ =Â close
upsÂ =Â 0.0
upsÂ :=Â priceÂ >Â price[1]Â ?Â nz(ups[1])Â +Â 1Â :Â 0
dnsÂ =Â 0.0
dnsÂ :=Â priceÂ <Â price[1]Â ?Â nz(dns[1])Â +Â 1Â :Â 0
golden_lineÂ =Â price5strategy
death_lineÂ =Â price4strategy
fast_lineÂ =Â price1strategy
slow_lineÂ =Â price3strategy
plot(golden_plotÂ ?Â golden_lineÂ :Â na,Â titleÂ =Â "GoldenÂ Line",Â colorÂ =Â color.white,Â linewidthÂ =Â 2)
plot(death_plotÂ ?Â death_lineÂ :Â na,Â "DeathÂ Line",Â colorÂ =Â color.yellow,Â linewidthÂ =Â 2)
plot(fast_plotÂ ?Â fast_lineÂ :Â na,Â "DeathÂ Line",Â colorÂ =Â color.blue,Â linewidthÂ =Â 1)
plot(slow_plotÂ ?Â slow_lineÂ :Â na,Â "DeathÂ Line",Â colorÂ =Â color.red,Â linewidthÂ =Â 1)
fastUpdeathÂ =Â ta.crossunder(fast_line,Â death_line)
fastDowndeathÂ =Â ta.crossover(fast_line,Â death_line)
//===============Â TAKEÂ PROFITÂ andÂ STOPÂ LOSSÂ byÂ %Â =================
tpsl(percent)Â =>
Â Â Â Â strategy.position_avg_priceÂ *Â percentÂ /Â 100Â /Â syminfo.mintick
GR4Â =Â "=====ğŸ†˜ğŸ†˜ğŸ†˜Â TAKEÂ PROFITÂ &Â STOPÂ LOSSÂ BYÂ [%]Â ğŸ†˜ğŸ†˜ğŸ†˜====="
GRHÂ =Â "ğŸ¯ğŸ¯ğŸ¯Â TakeProfitÂ &Â StopLossÂ MODEÂ ğŸ¯ğŸ¯ğŸ¯"
mode=Â input.bool(title="ğŸ†˜Â TakeÂ ProfitÂ &Â StopÂ LossÂ ByÂ PercentÂ (%)",Â defval=true,Â group=GRH,Â tooltipÂ =Â "TakeÂ ProfitÂ &Â StopÂ LossÂ byÂ %Â Change")
lengthBOÂ =Â input.int(title="1ï¸âƒ£Â LengthÂ BreakOut",Â minval=1,Â maxval=1000,Â defval=5,Â groupÂ =Â GR4)
BOTrail_MODEÂ =Â input.bool(defvalÂ =Â false,Â titleÂ =Â "ğŸ…¾ï¸Â CALLBACKÂ TrailingÂ StopÂ [LowÂ ProfitÂ ButÂ MoreÂ TP]",Â groupÂ =Â GRH,Â tooltipÂ =Â "BreakOutÂ LengthÂ ForÂ Who'sÂ WantÂ FastÂ TrailingÂ ButÂ ThisÂ LowÂ ProfitÂ ButÂ MoreÂ TimeÂ ForÂ TP\nIt'sÂ CanÂ ComboÂ WithÂ BreakoutÂ andÂ 15m")
triling_BOÂ =Â input.float(titleÂ =Â "ğŸ…¾ï¸Â BreakOutÂ TrailingÂ CALLBACKÂ [%]",Â defvalÂ =Â 25,Â minvalÂ =Â 0.01,Â maxvalÂ =Â 999.99,Â groupÂ =Â GR4,Â tooltipÂ =Â "BinanceÂ CallbackÂ =Â 5%,Â NowÂ YouÂ CanÂ CustomizeÂ YourÂ CallbackÂ ><")
plotcolorÂ =Â input.bool(defvalÂ =Â false,Â titleÂ =Â 'ğŸ†‘Â ATRÂ TrailingÂ Stop',Â groupÂ =Â GRH)
upBoundÂ =Â ta.highest(high,Â lengthBO)
downBoundÂ =Â ta.lowest(low,Â lengthBO)
SL_LongBOÂ =Â (closeÂ <Â (upBound-((upBound*triling_BO)/100)))
SL_ShortBOÂ =Â (closeÂ >Â (downBound+((downBound*triling_BO)/100)))
tp_lÂ =Â tpsl(input.float(99999,Â title='ğŸ†˜Â TPÂ [LONG]Â %',Â group=GR4))
tp_sÂ =Â tpsl(input.float(20,Â title='ğŸ†˜Â TPÂ [SHORT]Â %',Â group=GR4))
slÂ =Â tpsl(input.float(5,Â title='ğŸ†˜Â StopÂ LossÂ %',Â group=GR4))
GRTÂ =Â "=====ğŸ†‘ğŸ†‘ğŸ†‘Â ATRÂ TRAILINGÂ STOPÂ ğŸ†‘ğŸ†‘ğŸ†‘====="
/////////notes////////////////////////////////////////
//Â ThisÂ isÂ basedÂ onÂ theÂ ATRÂ trailingÂ stopÂ indicatorÂ //
//Â widthÂ additionÂ ofÂ twoÂ levelsÂ ofÂ stopsÂ andÂ Â Â Â Â Â Â Â //
//Â differentÂ interpretation.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //
//Â ThisÂ isÂ aÂ fast-reactingÂ systemÂ andÂ isÂ betterÂ Â Â Â Â //
//Â suitedÂ forÂ higherÂ volatilityÂ marketsÂ Â Â Â Â Â Â Â Â Â Â Â Â //
//////////////////////////////////////////////////////
Â 
//Â FastÂ TrailÂ //
AP1Â =Â input.int(5,Â 'ğŸ†‘Â FastÂ ATRÂ period',Â groupÂ =Â GRT)Â Â //Â ATRÂ Period
AF1Â =Â input.float(0.5,Â 'ğŸ†‘Â FastÂ ATRÂ multiplier',Â groupÂ =Â GRT)Â Â //Â ATRÂ Factor
SL1Â =Â AF1Â *Â ta.atr(AP1)Â Â //Â StopÂ Loss
Trail1Â =Â 0.0
iff_1Â =Â closeÂ >Â nz(Trail1[1],Â 0)Â ?Â closeÂ -Â SL1Â :Â closeÂ +Â SL1
iff_2Â =Â closeÂ <Â nz(Trail1[1],Â 0)Â andÂ close[1]Â <Â nz(Trail1[1],Â 0)Â ?Â math.min(nz(Trail1[1],Â 0),Â closeÂ +Â SL1)Â :Â iff_1
Trail1Â :=Â closeÂ >Â nz(Trail1[1],Â 0)Â andÂ close[1]Â >Â nz(Trail1[1],Â 0)Â ?Â math.max(nz(Trail1[1],Â 0),Â closeÂ -Â SL1)Â :Â iff_2
//Â SlowÂ TrailÂ //
AP2Â =Â input.int(10,Â 'ğŸ†‘Â SlowÂ ATRÂ period',Â groupÂ =Â GRT)Â Â //Â ATRÂ Period
AF2Â =Â input.float(2,Â 'ğŸ†‘Â SlowÂ ATRÂ multiplier',Â groupÂ =Â GRT)Â Â //Â ATRÂ Factor
SL2Â =Â AF2Â *Â ta.atr(AP2)Â Â //Â StopÂ Loss
Trail2Â =Â 0.0
iff_3Â =Â closeÂ >Â nz(Trail2[1],Â 0)Â ?Â closeÂ -Â SL2Â :Â closeÂ +Â SL2
iff_4Â =Â closeÂ <Â nz(Trail2[1],Â 0)Â andÂ close[1]Â <Â nz(Trail2[1],Â 0)Â ?Â math.min(nz(Trail2[1],Â 0),Â closeÂ +Â SL2)Â :Â iff_3
Trail2Â :=Â closeÂ >Â nz(Trail2[1],Â 0)Â andÂ close[1]Â >Â nz(Trail2[1],Â 0)Â ?Â math.max(nz(Trail2[1],Â 0),Â closeÂ -Â SL2)Â :Â iff_4
BuyLongÂ =Â ta.crossover(Trail1,Â Trail2)
SellShortÂ =Â ta.crossunder(Trail1,Â Trail2)
TS1Â =Â plot(plotcolorÂ ?Â Trail1Â :Â na,Â 'FastÂ Trail',Â style=plot.style_line,Â color=Trail1Â >Â Trail2Â ?Â color.blueÂ :Â color.yellow,Â linewidth=3,Â display=display.none)
TS2Â =Â plot(plotcolorÂ ?Â Trail2Â :Â na,Â 'SlowÂ Trail',Â style=plot.style_line,Â color=Trail1Â >Â Trail2Â ?Â color.limeÂ :Â color.blue,Â linewidth=3)
ifÂ plotcolorÂ ==Â true
Â Â Â Â ifÂ BuyLongÂ andÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â strategy.close('Short',Â qty_percentÂ =Â 100,Â commentÂ =Â "ğŸš¨ATRÂ TLğŸš¨")
Â Â Â Â ifÂ SellShortÂ andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â strategy.close('Long',Â qty_percentÂ =Â 100,Â commentÂ =Â "ğŸš¨ATRÂ TLğŸš¨")
calcStopLossPrice(OffsetPts)Â =>
Â Â Â Â ifÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â strategy.position_avg_priceÂ -Â OffsetPtsÂ *Â syminfo.mintick
Â Â Â Â elseÂ ifÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â strategy.position_avg_priceÂ +Â OffsetPtsÂ *Â syminfo.mintick
Â Â Â Â else
Â Â Â Â Â Â Â Â na
varÂ stoplossÂ =Â 0.
varÂ takeprofitÂ =Â 0.
ifÂ modeÂ ==Â true
Â Â Â Â ifÂ (strategy.position_sizeÂ >Â 0)
Â Â Â Â Â Â Â Â stoplossÂ :=Â calcStopLossPrice(sl)
Â Â Â Â Â Â Â Â takeprofitÂ :=Â tp_l
Â Â Â Â ifÂ (strategy.position_sizeÂ <Â 0)
Â Â Â Â Â Â Â Â stoplossÂ :=Â calcStopLossPrice(sl)
Â Â Â Â Â Â Â Â takeprofitÂ :=Â tp_s
Â Â Â Â elseÂ ifÂ strategy.position_sizeÂ ==Â 0
Â Â Â Â Â Â Â Â stoplossÂ :=Â na
Â Â Â Â Â Â Â Â takeprofitÂ :=Â na
/////////////////////////////////////////////////////////////////////////////////////////////////////
Text_Alert_FutureÂ =Â '{{strategy.order.alert_message}}'
copy_FuÂ =Â input(Â defval=Â Text_Alert_FutureÂ ,Â Â Â Â title="AlertÂ MessageÂ forÂ BOT",Â inlineÂ =Â '00'Â Â ,groupÂ =Â 'â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It'Â ,tooltipÂ =Â 'AlertÂ ForÂ X48-BOTÂ >Â CopyÂ andÂ PasteÂ ToÂ AlertÂ Function')
passphraseÂ =Â input.string(defval='1234',Â titleÂ ='BotÂ Pass',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â 'PassphraseÂ MustÂ BeÂ SameÂ asÂ X48-BOT')
leveragexÂ Â =Â input.int(125,title='leverage',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',tooltip='"NOTHING"Â toÂ doÂ withÂ PositionÂ sizeÂ ForÂ CommandÂ ToÂ X48-BOTÂ Only',minval=1)
longcommandÂ =Â input.string(defval='AutoLong',Â titleÂ =Â 'BotÂ LongÂ Command',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â '1.OpenLong\n2.AutoLong\n***IfÂ AutoLongÂ =Â Close(100%)Â FirstÂ >Â OpenÂ LongÂ PositionÂ Auto')
shortcommandÂ =Â input.string(defval='AutoShort',Â titleÂ =Â 'BotÂ ShortÂ Command',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â '1.OpenShort\n2.AutoShort\n***IfÂ AutoShortÂ =Â Close(100%)Â FirstÂ >Â OpenÂ ShortÂ PositionÂ Auto')
markettypeÂ =Â input.string(defval='bnfuture',Â titleÂ =Â 'Future/SpotÂ Command',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â '1.Â bnfutureÂ =Â FUTUREÂ MODE\n2.Â bnspotÂ =Â SPOTÂ MODE\nÂ 3.bncomboÂ =Â EZÂ 2in1Â Order')
////////////////Â StrategyÂ AlertÂ //////////////////////
////////Â ForÂ UseÂ BotÂ CanÂ ChangeÂ ThisÂ CommandÂ ByÂ YourÂ SelfÂ /////////////////////
stringÂ Alert_OpenLongÂ Â Â Â Â Â Â =Â '{"ex":"'+markettype+'","side":Â "'+longcommand+'",Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'",Â "tp"Â :Â "25",Â "sl"Â :Â "0",Â "tl"Â :Â "0",Â "callback"Â :Â "0"}'
stringÂ Alert_OpenShortÂ Â Â Â Â Â =Â '{"ex":"'+markettype+'","side":Â "'+shortcommand+'",Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'",Â "tp"Â :Â "25",Â "sl"Â :Â "0",Â "tl"Â :Â "0",Â "callback"Â :Â "0"}'
//stringÂ Alert_LongTPÂ Â Â Â Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseLong",Â "amount":Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//stringÂ Alert_ShortTPÂ Â Â Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseShort",Â "amount":Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//varÂ message_closelongÂ Â Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseLong",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//varÂ message_closeshortÂ Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseShort",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
stringÂ Alert_StopLosslongÂ Â Â =Â '{"ex":"'+markettype+'","side":Â "CloseLong",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'",Â "tp"Â :Â "0",Â "sl"Â :Â "0",Â "tl"Â :Â "0",Â "callback"Â :Â "0"}'
stringÂ Alert_StopLossshortÂ Â =Â '{"ex":"'+markettype+'","side":Â "CloseShort",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'",Â "tp"Â :Â "0",Â "sl"Â :Â "0",Â "tl"Â :Â "0",Â "callback"Â :Â "0"}'
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////Â INPUTÂ BACKTESTÂ RANGEÂ ////////////////////////////////////////////////////
varÂ stringÂ BTR1Â Â Â Â Â Â Â Â Â =Â 'â•â•â•â•â•â•â•â•Â INPUTÂ BACKTESTÂ TIMEÂ RANGEÂ â•â•â•â•â•â•â•â•'
i_startTimeÂ Â Â Â Â Â Â Â Â Â Â Â Â =Â input.time(defvalÂ =Â timestamp("01Â JanÂ 1945Â 00:00Â +0000"),Â titleÂ =Â "Start",Â inline="timestart",Â group=BTR1,Â tooltipÂ =Â 'StartÂ BacktestÂ YYYY/MM/DD')
i_endTimeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.time(defvalÂ =Â timestamp("01Â JanÂ 2074Â 23:59Â +0000"),Â titleÂ =Â "End",Â inline="timeend",Â group=BTR1,Â tooltipÂ =Â 'EndÂ BacktestÂ YYYY/MM/DD')
ifÂ timeÂ >=Â i_startTimeÂ andÂ timeÂ <=Â i_endTime
Â Â Â Â ifÂ Spot_MODEÂ ==Â false
Â Â Â Â Â Â Â Â ifÂ (upsÂ >=Â consecutiveBarsUp)Â andÂ closeÂ >Â golden_lineÂ andÂ fast_lineÂ >Â golden_line
Â Â Â Â Â Â Â Â Â Â Â Â strategy.entry("Long",Â strategy.long,Â comment="ğŸŒ™",Â alert_messageÂ =Â Alert_OpenLong)
Â Â Â Â Â Â Â Â ifÂ (dnsÂ >=Â consecutiveBarsDown)Â andÂ closeÂ <Â golden_lineÂ andÂ fast_lineÂ <Â golden_line
Â Â Â Â Â Â Â Â Â Â Â Â strategy.entry("Short",Â strategy.short,Â comment="ğŸ‘»",Â alert_messageÂ =Â Alert_OpenShort)
Â Â Â Â Â Â Â Â ifÂ Auto_StopÂ ==Â true
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (dnsÂ >=Â consecutiveBarsDownStop)Â andÂ closeÂ >Â golden_lineÂ andÂ close[2]Â <Â death_lineÂ andÂ close[1]Â <Â death_lineÂ andÂ closeÂ <Â death_lineÂ orÂ fastUpdeath
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Long",Â qty_percentÂ =Â 100,Â commentÂ =Â "ğŸ””AUTOğŸ””",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (upsÂ >=Â consecutiveBarsUp)Â andÂ closeÂ <Â golden_lineÂ andÂ close[2]Â >Â death_lineÂ andÂ close[1]Â >Â death_lineÂ andÂ closeÂ >Â death_lineÂ orÂ fastDowndeath
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Short",Â qty_percentÂ =Â 100,Â commentÂ =Â "ğŸ””AUTOğŸ””",Â alert_messageÂ =Â Alert_StopLossshort)
Â Â Â Â ifÂ Spot_MODEÂ ==Â true
Â Â Â Â Â Â Â Â ifÂ (upsÂ >=Â consecutiveBarsUp)Â andÂ closeÂ >Â golden_lineÂ andÂ fast_lineÂ >Â golden_line
Â Â Â Â Â Â Â Â Â Â Â Â strategy.entry("Long",Â strategy.long,Â comment="ğŸŒ™",Â alert_messageÂ =Â Alert_OpenLong)
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â ifÂ Auto_StopÂ ==Â true
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (dnsÂ >=Â consecutiveBarsDownStop)Â andÂ closeÂ >Â golden_lineÂ andÂ close[2]Â <Â death_lineÂ andÂ close[1]Â <Â death_lineÂ andÂ closeÂ <Â death_lineÂ orÂ fastUpdeath
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Long",Â qty_percentÂ =Â 100,Â commentÂ =Â "ğŸ””AUTOğŸ””",Â alert_messageÂ =Â Alert_StopLosslong)
ifÂ modeÂ ==Â true
Â Â Â Â ifÂ Spot_MODEÂ ==Â false
Â Â Â Â Â Â Â Â ifÂ tp_lÂ >Â 0Â andÂ slÂ >Â 0Â andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â profitÂ =Â takeprofit,Â stopÂ =Â stoploss,Â comment_profitÂ =Â "TPğŸ’šL",Â comment_lossÂ =Â "SLğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ tp_lÂ >Â 0Â andÂ slÂ <=Â 0Â andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â profitÂ =Â takeprofit,Â comment_profitÂ =Â "TPğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ tp_lÂ <=Â 0Â andÂ slÂ >Â 0Â andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â stopÂ =Â stoploss,Â comment_lossÂ =Â "SLğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ tp_sÂ >Â 0Â andÂ slÂ >Â 0Â andÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Short',Â qty_percentÂ =Â 100,Â profitÂ =Â takeprofit,Â stopÂ =Â stoploss,Â comment_profitÂ =Â "TPâ¤ï¸ï¸S",Â comment_lossÂ =Â "SLâ¤ï¸ï¸S",Â alert_messageÂ =Â Alert_StopLossshort)
Â Â Â Â Â Â Â Â ifÂ tp_sÂ >Â 0Â andÂ slÂ <=Â 0Â andÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Short',Â qty_percentÂ =Â 100,Â profitÂ =Â takeprofit,Â comment_profitÂ =Â "TPâ¤ï¸ï¸S",Â alert_messageÂ =Â Alert_StopLossshort)
Â Â Â Â Â Â Â Â ifÂ tp_sÂ <=Â 0Â andÂ slÂ >Â 0Â andÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Short',Â qty_percentÂ =Â 100,Â stopÂ =Â stoploss,Â comment_lossÂ =Â "SLâ¤ï¸ï¸S",Â alert_messageÂ =Â Alert_StopLossshort)
Â Â Â Â ifÂ Spot_MODEÂ ==Â true
Â Â Â Â Â Â Â Â ifÂ tp_lÂ >Â 0Â andÂ slÂ >Â 0Â andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â profitÂ =Â takeprofit,Â lossÂ =Â stoploss,Â comment_profitÂ =Â "TPğŸ’šL",Â comment_lossÂ =Â "SLğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ tp_lÂ >Â 0Â andÂ slÂ <=Â 0Â andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â profitÂ =Â takeprofit,Â comment_profitÂ =Â "TPğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ tp_lÂ <=Â 0Â andÂ slÂ >Â 0Â andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â lossÂ =Â stoploss,Â comment_lossÂ =Â "SLğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
ifÂ BOTrail_MODEÂ ==Â true
Â Â Â Â ifÂ Spot_MODEÂ ==Â false
Â Â Â Â Â Â Â Â ifÂ SL_LongBOÂ andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Long",Â qty_percentÂ =Â 100,Â commentÂ =Â "â‡ï¸CALLBACKâ‡ï¸",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ SL_ShortBOÂ andÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Short",Â qty_percentÂ =Â 100,Â commentÂ =Â "â‡ï¸CALLBACKâ‡ï¸",Â alert_messageÂ =Â Alert_StopLossshort)
Â Â Â Â ifÂ Spot_MODEÂ ==Â true
Â Â Â Â Â Â Â Â ifÂ SL_LongBOÂ andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Long",Â qty_percentÂ =Â 100,Â commentÂ =Â "â‡ï¸CALLBACKâ‡ï¸",Â alert_messageÂ =Â Alert_StopLosslong)
//=====================Â à¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰Â Â libraryÂ =========================
importÂ X4815162342/X48_LibaryStrategyStatus/2Â asÂ fuLiÂ 
//à¹à¸ªà¸”à¸‡à¸œà¸¥Â Backtest
show_NetÂ =Â input.bool(true,'MonitorÂ Profit&Loss',Â inlineÂ =Â 'Lnet',Â groupÂ =Â '=Â PNLÂ MONITORÂ SETTINGÂ =')
position_Â =Â input.string('bottom_center','Position',Â optionsÂ =Â ['top_right','middle_right','bottom_right','top_center','middle_center','bottom_center','middle_left','bottom_left']Â ,Â inlineÂ =Â 'Lnet')
size_iÂ =Â input.string('auto','size',Â optionsÂ =Â ['auto','tiny','small','normal']Â ,Â inlineÂ =Â 'Lnet')Â 
color_NetÂ =Â input.color(color.blue,""Â ,Â inlineÂ =Â 'Lnet')
fuLi.NetProfit_Show(show_NetÂ ,Â position_Â ,Â size_i,Â Â color_NetÂ )
Expand (291 lines)