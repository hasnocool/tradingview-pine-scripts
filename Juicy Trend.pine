Script Name: Juicy Trend
Author: UnknownUnicorn28067390
Description: This script is simple.
It uses EMA and HMA crosses to find entries and exits.
There is an option for sourcing Heikin Ashi based entries/exits.
There is an option for Stop Loss percentage.
It is made for finding Long entries on the 45min chart.
You can optimize the signals by adjusting the moving average lengths.
The default settings are for BTC/USDT...
PineScript code:

Pine Scriptâ„¢ strategy
Juicy Trend
Copy code
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
c="â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â Â Â â–ˆâ–ˆâ•—Â Â Â â–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ•—Â Â Â â–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ•—Â Â â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—Â Â â–ˆâ–ˆâ•—"
o="â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—Â Â â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•Â â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ•‘"
d="Â Â â–ˆâ–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â â•šâ•â•Â Â â•šâ–ˆâ–ˆâ•—Â â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•—Â â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘"
e="â–ˆâ–ˆâ•”â•â•â•Â Â â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•—Â Â Â â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•Â â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â Â â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘"
r="â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•Â Â Â Â â•šâ–ˆâ–ˆâ•”â•Â Â â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘Â Â â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘Â â•šâ–ˆâ–ˆâ–ˆâ•‘"
s="â•šâ•â•â•â•â•â•â•â•šâ•â•Â Â â•šâ•â•Â â•šâ•â•â•â•â•Â Â Â Â Â Â â•šâ•â•Â Â Â â•šâ•â•Â Â â•šâ•â•Â â•šâ•â•â•â•â•â•Â Â â•šâ•â•â•â•â•â•Â â•šâ•â•Â Â â•šâ•â•â•šâ•â•Â Â â•šâ•â•â•"
//@version=5
strategy("ğ‰ğ”ğˆğ‚ğ˜Â ğ“ğ‘ğ„ğğƒ",Â overlay=true,Â initial_capital=2000,Â default_qty_type=strategy.percent_of_equity,Â default_qty_value=30,Â commission_value=0.075)
//ToolÂ Tips/////////////////////////////////////////////////////////////////////
tttradetrendÂ Â Â Â Â Â Â Â =Â "OnlyÂ \"BUY\"Â whenÂ \"MAÂ 3\"Â isÂ trendingÂ up.Â IfÂ enabled,Â \"BUY\"Â ordersÂ willÂ notÂ beÂ executedÂ whenÂ \"MAÂ 3\"Â isÂ goingÂ down.\nThisÂ canÂ helpÂ reduceÂ drawdownÂ andÂ increaseÂ profitability,Â butÂ usuallyÂ decreasesÂ netÂ profitÂ significantly.\nMoreÂ tradesÂ willÂ endÂ inÂ profit,Â butÂ youÂ willÂ missÂ outÂ onÂ manyÂ profitableÂ opportunities."
ttsellaftertrendÂ Â Â Â =Â "IfÂ youÂ areÂ onlyÂ tradingÂ withÂ theÂ trend,Â thereÂ mayÂ beÂ aÂ positionÂ whichÂ remainsÂ openÂ afterÂ thatÂ trendÂ hasÂ ended./nThisÂ optionÂ willÂ forceÂ thatÂ finalÂ tradeÂ toÂ closeÂ toÂ limitÂ theÂ lossÂ andÂ getÂ theÂ strategyÂ backÂ intoÂ actionÂ onÂ theÂ nextÂ uptrend."
ttselloutÂ Â Â Â Â Â Â Â Â Â Â =Â "IfÂ \"SellÂ AfterÂ TrendÂ Reverses\"Â isÂ enabled,Â theÂ positionÂ willÂ beÂ soldÂ thisÂ numberÂ ofÂ bars/candlesÂ afterÂ theÂ trendÂ hasÂ reversedÂ down."
ttsellinprofitÂ Â Â Â Â Â =Â "OnlyÂ exitÂ tradesÂ whenÂ theÂ positionÂ isÂ inÂ profitÂ orÂ whenÂ theÂ stopÂ lossÂ isÂ triggered.\nIfÂ enabled,Â andÂ \"UseÂ StopÂ Loss\"Â isÂ disabled,Â theÂ tradeÂ mayÂ waitÂ aÂ longÂ timeÂ beforeÂ theÂ priceÂ comesÂ upÂ intoÂ profit."
ttminimumprofitÂ Â Â Â Â =Â "IfÂ \"OnlyÂ SellÂ inÂ Profit\"Â isÂ enabled,Â thisÂ determinesÂ howÂ farÂ inÂ profitÂ theÂ positionÂ mustÂ beÂ forÂ aÂ sellÂ signalÂ toÂ beÂ valid."
ttusetakeprofitÂ Â Â Â Â =Â "UseÂ theÂ takeÂ profitÂ percentageÂ toÂ prematurelyÂ endÂ tradesÂ inÂ profit.Â ThisÂ mayÂ decreaseÂ theÂ numberÂ ofÂ losingÂ trades."
tttakeprofitpercentÂ =Â "SetÂ howÂ farÂ theÂ priceÂ shouldÂ climbÂ beforeÂ theÂ tradeÂ isÂ closedÂ atÂ marketÂ priceÂ inÂ profit.\nÂ ItÂ mayÂ beÂ moreÂ profitableÂ toÂ prematurelyÂ closeÂ aÂ tradeÂ becauseÂ aÂ sellÂ signalÂ mightÂ notÂ beÂ triggeredÂ dependingÂ onÂ priceÂ action."
ttusestoplossÂ Â Â Â Â Â Â =Â "UseÂ theÂ stopÂ lossÂ percentageÂ toÂ limitÂ theÂ lossÂ enduredÂ whenÂ theÂ priceÂ dumps.\nIfÂ disabled,Â andÂ \"OnlyÂ SellÂ inÂ Profit\"Â isÂ disabled,Â theÂ priceÂ couldÂ dumpÂ andÂ thenÂ receiveÂ aÂ sellÂ signalÂ atÂ aÂ losingÂ position."
ttstoplosspercentÂ Â Â =Â "SetÂ howÂ farÂ theÂ priceÂ shouldÂ dropÂ beforeÂ theÂ tradeÂ isÂ closedÂ atÂ marketÂ priceÂ inÂ aÂ loss.\nItÂ mayÂ beÂ moreÂ profitableÂ longÂ termÂ toÂ endureÂ largerÂ losses,Â lessÂ often."
ttexpireoptionÂ Â Â Â Â Â =Â "ThisÂ featureÂ forcesÂ aÂ tradeÂ toÂ closeÂ atÂ marketÂ priceÂ afterÂ theÂ chosenÂ numberÂ ofÂ candles/barsÂ haveÂ passed.\nÂ ToÂ clarify,Â ifÂ noÂ sell/stop/takeÂ signalÂ wasÂ receivedÂ thenÂ theÂ tradeÂ willÂ closeÂ inÂ aÂ profitÂ orÂ lossÂ afterÂ theÂ chosenÂ numberÂ ofÂ candles/barsÂ haveÂ passed."
ttexpiretimeÂ Â Â Â Â Â Â Â =Â "ChooseÂ howÂ manyÂ bars/candlesÂ shouldÂ passÂ beforeÂ theÂ tradeÂ expiresÂ andÂ closesÂ atÂ marketÂ price.\nInÂ aÂ downtrendÂ onÂ MAÂ 3,Â thisÂ valueÂ isÂ halved."
ttma1Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â "\"MAÂ 1\"Â shouldÂ followÂ theÂ priceÂ closelyÂ whileÂ reducingÂ asÂ muchÂ noiseÂ asÂ possible.\n\"BUY\"Â andÂ \"SELL\"Â signalsÂ areÂ basedÂ onÂ \"MAÂ 1\"Â andÂ \"MAÂ 2\"Â crosses.\nAdjustÂ themÂ toÂ flowÂ withÂ yourÂ assetÂ andÂ timeframeÂ asÂ profitablyÂ asÂ possible."
ttma2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â "\"MAÂ 2\"Â shouldÂ notÂ makeÂ contactÂ withÂ \"MAÂ 1\"Â untilÂ theÂ directionÂ ofÂ priceÂ hasÂ startedÂ reversing.\nTryÂ toÂ keepÂ theÂ linesÂ seperated,Â onlyÂ crossingÂ onÂ pivotÂ highsÂ andÂ pivotÂ lows."
ttma3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â "IfÂ \"OnlyÂ TradeÂ withÂ Trend\"Â isÂ enabled,Â \"MAÂ 3\"Â willÂ restrictÂ tradesÂ toÂ it'sÂ direction.\n\"BUY\"Â tradesÂ willÂ onlyÂ beÂ executedÂ inÂ anÂ uptrend."
ttusestochrsiÂ Â Â Â Â Â Â =Â "DecideÂ whetherÂ toÂ considerÂ theÂ positionÂ ofÂ theÂ StochasticÂ RSI.Â IfÂ enabled,Â aÂ \"BUY\"Â orderÂ willÂ onlyÂ beÂ executedÂ ifÂ theÂ StochasticÂ RSIÂ isÂ belowÂ theÂ decidedÂ level."
ttstochrsilevelÂ Â Â Â Â =Â "AÂ \"BUY\"Â orderÂ canÂ onlyÂ beÂ executedÂ ifÂ theÂ StochasticÂ RSIÂ isÂ belowÂ thisÂ level."
ttlengthRSIÂ Â Â Â Â Â Â Â Â =Â "TheÂ priceÂ actionÂ ofÂ everyÂ assetÂ isÂ different,Â soÂ theÂ StochasticÂ RSIÂ mustÂ beÂ tunedÂ andÂ timedÂ withÂ theÂ market.\nTakingÂ theÂ timeÂ toÂ adjustÂ thisÂ valueÂ willÂ haveÂ aÂ greatÂ impactÂ onÂ profitability."
ttlengthStochÂ Â Â Â Â Â Â =Â "TheÂ StochasticÂ lengthÂ shouldÂ typicallyÂ beÂ slightlyÂ longerÂ thanÂ theÂ RSIÂ length.Â AfterÂ adjustingÂ allÂ settings,Â startÂ fromÂ theÂ topÂ andÂ doÂ itÂ again.\nRepeatedlyÂ tuningÂ thisÂ indicatorÂ fromÂ topÂ toÂ bottomÂ willÂ giveÂ youÂ theÂ bestÂ results."
ttbuystringÂ Â Â Â Â Â Â Â Â =Â "InsertÂ yourÂ customÂ alertÂ messageÂ forÂ placingÂ aÂ \"BUY\"Â orderÂ here.\nIfÂ you'reÂ usingÂ aÂ 3CommasÂ bot,Â insertÂ theÂ \"DealÂ Start\"Â messageÂ hereÂ withÂ aÂ forwardÂ slashÂ beforeÂ eachÂ quotation.\nSelectÂ \"Alert()Â functionÂ callsÂ only\"Â inÂ theÂ alertÂ options."
ttsellstringÂ Â Â Â Â Â Â Â =Â "InsertÂ yourÂ customÂ alertÂ messageÂ forÂ placingÂ aÂ \"SELL\"Â orderÂ here.\nIfÂ you'reÂ usingÂ aÂ 3CommasÂ bot,Â insertÂ theÂ \"DealÂ Close\"Â messageÂ hereÂ withÂ aÂ forwardÂ slashÂ beforeÂ eachÂ quotation.\nSelectÂ \"Alert()Â functionÂ callsÂ only\"Â inÂ theÂ alertÂ options."
tttakestringÂ Â Â Â Â Â Â Â =Â "InsertÂ yourÂ customÂ alertÂ messageÂ forÂ placingÂ aÂ \"TAKE\"Â orderÂ here.\nIfÂ you'reÂ usingÂ aÂ 3CommasÂ bot,Â insertÂ theÂ \"DealÂ Close\"Â messageÂ hereÂ withÂ aÂ forwardÂ slashÂ beforeÂ eachÂ quotation.\nSelectÂ \"Alert()Â functionÂ callsÂ only\"Â inÂ theÂ alertÂ options."
ttstopstringÂ Â Â Â Â Â Â Â =Â "InsertÂ yourÂ customÂ alertÂ messageÂ forÂ placingÂ aÂ \"STOP\"Â orderÂ here.\nIfÂ you'reÂ usingÂ aÂ 3CommasÂ bot,Â insertÂ theÂ \"DealÂ Close\"Â messageÂ hereÂ withÂ aÂ forwardÂ slashÂ beforeÂ eachÂ quotation.\nSelectÂ \"Alert()Â functionÂ callsÂ only\"Â inÂ theÂ alertÂ options."
ttexpirestringÂ Â Â Â Â Â =Â "InsertÂ yourÂ customÂ alertÂ messageÂ forÂ placingÂ aÂ \"EXPIRE\"Â orderÂ here.\nIfÂ you'reÂ usingÂ aÂ 3CommasÂ bot,Â insertÂ theÂ \"DealÂ Close\"Â messageÂ hereÂ withÂ aÂ forwardÂ slashÂ beforeÂ eachÂ quotation.\nSelectÂ \"Alert()Â functionÂ callsÂ only\"Â inÂ theÂ alertÂ options."
//Options///////////////////////////////////////////////////////////////////////
tradetrendoptionÂ Â Â Â =Â input(false,Â title="OnlyÂ TadeÂ withÂ Trend",Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=tttradetrend)
sellaftertrendÂ Â Â Â Â Â =Â input(false,Â title="SellÂ AfterÂ TrendÂ Reverses",Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttsellaftertrend)
selloutÂ Â Â Â Â Â Â Â Â Â Â Â Â =Â input.int(title="SellÂ AfterÂ (bars)",Â Â Â Â defval=10,Â Â minval=0,Â Â Â maxval=10000,Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttsellout)
sellinprofitoptionÂ Â =Â input(true,Â Â title="OnlyÂ SellÂ inÂ Profit",Â Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttsellinprofit)
minimumprofitÂ Â Â Â Â Â Â =Â input.float(title="MinimumÂ ProfitÂ (%)",Â defval=3.5,Â minval=0,Â Â Â maxval=100,Â Â step=.1,Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttminimumprofit)Â /Â 100
usetakeprofitoptionÂ =Â input(true,Â Â title="UseÂ TakeÂ Profit",Â Â Â Â Â Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttusetakeprofit)
takeprofitpercentÂ Â Â =Â input.float(title="TakeÂ ProfitÂ (%)",Â Â Â Â defval=11.5,Â Â minval=0,Â Â Â maxval=1000,Â step=.1,Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=tttakeprofitpercent)Â /Â 100
usestoplossoptionÂ Â Â =Â input(true,Â Â title="UseÂ StopÂ Loss",Â Â Â Â Â Â Â Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttusestoploss)
stoplosspercentÂ Â Â Â Â =Â input.float(title="StopÂ LossÂ (%)",Â Â Â Â Â Â defval=-7.5,Â Â minval=-50,Â maxval=0,Â Â Â Â step=.1,Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttstoplosspercent)Â /Â 100
usetradeexpirationÂ Â =Â input(true,Â title="UseÂ TradeÂ Expiration",Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttexpireoption)
expirationtimeÂ Â Â Â Â Â =Â input.int(title="ExpireÂ AfterÂ (bars)",Â Â defval=158,Â Â minval=1,Â Â Â maxval=10000,Â group="ğ“ğ‘ğ€ğƒğ„Â ğğğ“ğˆğğğ’",Â tooltip=ttexpiretime)
//MovingÂ Averages///////////////////////////////////////////////////////////////
srcÂ =Â close
ma(source,Â length,Â type)Â =>
Â Â Â Â Â typeÂ ==Â "SMA"Â Â ?Â ta.sma(source,Â length)Â :
Â Â Â Â Â typeÂ ==Â "EMA"Â Â ?Â ta.ema(source,Â length)Â :
Â Â Â Â Â typeÂ ==Â "RMA"Â Â ?Â ta.rma(source,Â length)Â :
Â Â Â Â Â typeÂ ==Â "HMA"Â Â ?Â ta.wma(2*ta.wma(source,Â length/2)-ta.wma(source,Â length),Â math.floor(math.sqrt(length)))Â :
Â Â Â Â Â typeÂ ==Â "WMA"Â Â ?Â ta.wma(source,Â length)Â :
Â Â Â Â Â typeÂ ==Â "VWMA"Â ?Â ta.vwma(source,Â length)Â :
Â Â Â Â Â na
//MA1
ma1_typeÂ Â Â =Â input.string("RMA",Â "MAÂ 1",Â inline="MAÂ 1",Â options=["SMA",Â "EMA",Â "RMA",Â "HMA",Â "WMA",Â "VWMA"],Â group="ğŒğğ•ğˆğğ†Â ğ€ğ•ğ„ğ‘ğ€ğ†ğ„ğ’")
ma1_lengthÂ =Â input.int(7,Â "",Â inline="MAÂ 1",Â minval=1,Â group="ğŒğğ•ğˆğğ†Â ğ€ğ•ğ„ğ‘ğ€ğ†ğ„ğ’",Â tooltip=ttma1)
ma1Â =Â ma(src,Â ma1_length,Â ma1_type)
ma1lineÂ =Â plot(ma1,Â color=color.blue,Â linewidth=2,Â title="MAÂ 1")
//MA2
ma2_typeÂ Â Â =Â input.string("HMA",Â "MAÂ 2",Â inline="MAÂ 2",Â options=["SMA",Â "EMA",Â "RMA",Â "HMA",Â "WMA",Â "VWMA"],Â group="ğŒğğ•ğˆğğ†Â ğ€ğ•ğ„ğ‘ğ€ğ†ğ„ğ’")
ma2_lengthÂ =Â input.int(54,Â "",Â inline="MAÂ 2",Â minval=1,Â group="ğŒğğ•ğˆğğ†Â ğ€ğ•ğ„ğ‘ğ€ğ†ğ„ğ’",Â tooltip=ttma2)
ma2Â =Â ma(src,Â ma2_length,Â ma2_type)
ma2lineÂ =Â plot(ma2,Â color=color.purple,Â linewidth=2,Â title="MAÂ 2")
fillcolorÂ =Â ma1Â >Â ma2Â ?Â color.blueÂ :Â color.purple
fill(ma1line,Â ma2line,Â title="EMAÂ Fill",Â color=color.new(fillcolor,Â 80),Â editable=true)
//MA3
ma3_typeÂ Â Â =Â input.string("EMA",Â "MAÂ 3",Â inline="MAÂ 3",Â options=["SMA",Â "EMA",Â "RMA",Â "HMA",Â "WMA",Â "VWMA"],Â group="ğŒğğ•ğˆğğ†Â ğ€ğ•ğ„ğ‘ğ€ğ†ğ„ğ’")
ma3_lengthÂ =Â input.int(200,Â "",Â inline="MAÂ 3",Â step=5,Â minval=10,Â group="ğŒğğ•ğˆğğ†Â ğ€ğ•ğ„ğ‘ğ€ğ†ğ„ğ’",Â tooltip=ttma3)
ma3Â =Â ma(src,Â ma3_length,Â ma3_type)
trendcolorÂ =Â ma3Â >Â ma3[1]Â ?Â color.blueÂ :Â color.purple
ma3lineÂ =Â plot(ma3,Â color=trendcolor,Â linewidth=2,Â title="MAÂ 3")
//StochasticÂ RSI////////////////////////////////////////////////////////////////
usestochrsiÂ =Â input(true,Â title="UseÂ StochÂ RSI",Â group="ğ’ğ“ğğ‚ğ‡ğ€ğ’ğ“ğˆğ‚Â ğ‘ğ’ğˆ",Â tooltip=ttusestochrsi)
stochrsilevelÂ =Â input.int(defval=61,Â minval=5,Â maxval=95,Â title="StochÂ RSIÂ LessÂ Than",Â group="ğ’ğ“ğğ‚ğ‡ğ€ğ’ğ“ğˆğ‚Â ğ‘ğ’ğˆ",Â tooltip=ttstochrsilevel)
lengthRSIÂ =Â input.int(12,Â "RSIÂ Length",Â minval=1,Â group="ğ’ğ“ğğ‚ğ‡ğ€ğ’ğ“ğˆğ‚Â ğ‘ğ’ğˆ",Â tooltip=ttlengthRSI)
lengthStochÂ =Â input.int(20,Â "StochÂ Length",Â minval=1,Â group="ğ’ğ“ğğ‚ğ‡ğ€ğ’ğ“ğˆğ‚Â ğ‘ğ’ğˆ",Â tooltip=ttlengthStoch)
rsi1Â =Â ta.rsi(src,Â lengthRSI)
smoothKÂ =Â 3
kÂ =Â ta.sma(ta.stoch(rsi1,Â rsi1,Â rsi1,Â lengthStoch),Â smoothK)
//BuyÂ SellÂ Conditions///////////////////////////////////////////////////////////
buyÂ Â Â Â Â Â Â Â Â Â =Â ma1Â >Â ma2
buystochrsiÂ Â =Â buyÂ andÂ kÂ <Â stochrsilevel
buywithtrendÂ =Â buyÂ andÂ ma3Â >Â ma3[1]
buystochrsitrueÂ =Â usestochrsiÂ Â Â Â Â Â ?Â buystochrsiÂ Â :Â buy
buytrendtrueÂ Â Â Â =Â tradetrendoptionÂ ?Â buywithtrendÂ :Â buy
buyoptionÂ Â Â Â =Â buystochrsitrueÂ andÂ buytrendtrue
mpconvertÂ Â Â Â =Â strategy.position_avg_priceÂ *Â (1Â +Â minimumprofit)
mpnarrowÂ Â Â Â Â =Â mpconvertÂ <Â closeÂ andÂ strategy.openprofitÂ >Â 0
sellÂ Â Â Â Â Â Â Â Â =Â ma1Â <Â ma2
sellinprofitÂ =Â sellÂ andÂ mpnarrow
selloptionÂ Â Â =Â sellaftertrendÂ ?Â ma3Â <Â ma3[sellout]Â orÂ (sellinprofitoptionÂ ?Â sellinprofitÂ :Â sell)Â :Â (sellinprofitoptionÂ ?Â sellinprofitÂ :Â sell)
takeÂ Â Â Â Â Â Â Â Â =Â strategy.position_avg_priceÂ *Â (1Â +Â takeprofitpercent)
takeoptionÂ Â Â =Â takeÂ <Â closeÂ andÂ usetakeprofitoption
stopÂ Â Â Â Â Â Â Â Â =Â strategy.position_avg_priceÂ *Â (1Â +Â stoplosspercent)
stopoptionÂ Â Â =Â stopÂ >Â closeÂ andÂ usestoplossoption
//TheÂ codeÂ belowÂ extendsÂ theÂ expirationÂ toÂ 1,000,000Â barsÂ ifÂ expirationÂ isÂ disabled.Â ThisÂ ensuresÂ thatÂ noÂ tradeÂ willÂ expire.
tradeexpireextendÂ Â Â =Â usetradeexpirationÂ ?Â expirationtimeÂ :Â 1000000
expirereductionÂ Â Â Â Â =Â ma3Â <Â ma3[1]Â ?Â tradeexpireextendÂ /Â 2Â :Â tradeexpireextend
//AlternateÂ LabelsÂ andÂ Expire///////////////////////////////////////////////////
//Don'tÂ RepeatÂ BuyÂ orÂ SellÂ signals
varÂ posÂ =Â 0
ifÂ buyoptionÂ andÂ posÂ <=Â 0
Â Â Â Â posÂ :=Â 1
ifÂ selloptionÂ orÂ stopoptionÂ orÂ takeoptionÂ andÂ posÂ >=Â 0
Â Â Â Â posÂ :=Â -1
buyposÂ Â =Â posÂ ==Â Â 1Â andÂ (posÂ !=Â Â 1)[1]
sellposÂ =Â posÂ ==Â -1Â andÂ (posÂ !=Â -1)[1]
//ExpireÂ ConditionsÂ andÂ DeclareÂ PositionÂ toÂ beÂ theÂ sameÂ asÂ aÂ sellÂ position.
expireÂ =Â ta.barssince(buypos)Â >Â tradeexpireextend
ifÂ expireÂ andÂ posÂ >=Â 0
Â Â Â Â posÂ :=Â -1
expireposÂ =Â posÂ ==Â -1Â andÂ (posÂ !=Â -1)[1]Â andÂ expire
//SellÂ OnlyÂ AppliesÂ ifÂ OtherÂ CloseÂ ConditionsÂ areÂ False
sellvsotherÂ =Â stopoptionÂ orÂ takeoptionÂ orÂ expireÂ ?Â naÂ :Â sellpos
//FinalizeÂ Signals//////////////////////////////////////////////////////////////
buyfinalÂ Â Â Â =Â buypos
sellfinalÂ Â Â =Â sellvsother
takefinalÂ Â Â =Â takeoption
stopfinalÂ Â Â =Â stopoption
expirefinalÂ =Â expirepos
//Trades////////////////////////////////////////////////////////////////////////
ifÂ buyfinal
Â Â Â Â strategy.entry("LongÂ Position",Â strategy.long,Â comment="BUY")
ifÂ sellfinal
Â Â Â Â strategy.close("LongÂ Position",Â comment="SELL")
ifÂ takefinal
Â Â Â Â strategy.close("LongÂ Position",Â comment="TAKE")
ifÂ stopfinal
Â Â Â Â strategy.close("LongÂ Position",Â comment="STOP")
ifÂ expirefinal
Â Â Â Â strategy.close("LongÂ Position",Â comment="EXPIRE")
//PlotÂ Labels///////////////////////////////////////////////////////////////////
plotshape(buyfinal,Â Â Â Â style=shape.labelup,Â Â Â location=location.belowbar,Â color=color.blue,Â Â Â text="ğğ”ğ˜",Â Â Â Â Â Â Â textcolor=color.white,Â size=size.tiny)
plotshape(sellfinal,Â Â Â style=shape.labeldown,Â location=location.abovebar,Â color=color.purple,Â text="ğ’ğ„ğ‹ğ‹",Â Â Â Â Â textcolor=color.white,Â size=size.tiny)
plotshape(takefinal,Â Â Â style=shape.labeldown,Â location=location.abovebar,Â color=color.black,Â Â text="ğ“ğ€ğŠğ„",Â Â Â Â Â textcolor=#26a69a,Â Â Â Â Â size=size.tiny)
plotshape(stopfinal,Â Â Â style=shape.labelup,Â Â Â location=location.belowbar,Â color=color.black,Â Â text="ğ’ğ“ğğ",Â Â Â Â Â textcolor=#ef5350,Â Â Â Â Â size=size.tiny)
plotshape(expirefinal,Â style=shape.labeldown,Â location=location.abovebar,Â color=color.black,Â Â text="ğ„ğ—ğğˆğ‘ğ„",Â textcolor=#ffeb3b,Â Â Â Â Â size=size.tiny)
//Alerts////////////////////////////////////////////////////////////////////////
usebuyalertÂ Â Â Â =Â input(defval=true,Â title="UseÂ BUYÂ Alert",Â Â Â Â Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’")
buystringÂ Â Â Â Â Â =Â input.string(title="BuyÂ AlertÂ Message",Â Â Â Â defval="BUY",Â Â Â Â confirm=false,Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’",Â tooltip=ttbuystring)
usesellalertÂ Â Â =Â input(defval=true,Â title="UseÂ SELLÂ Alert",Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’")
sellstringÂ Â Â Â Â =Â input.string(title="SellÂ AlertÂ Message",Â Â Â defval="SELL",Â Â Â confirm=false,Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’",Â tooltip=ttsellstring)
usetakealertÂ Â Â =Â input(defval=true,Â title="UseÂ TAKEÂ Alert",Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’")
takestringÂ Â Â Â Â =Â input.string(title="TakeÂ AlertÂ Message",Â Â Â defval="TAKE",Â Â Â confirm=false,Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’",Â tooltip=tttakestring)
usestopalertÂ Â Â =Â input(defval=true,Â title="UseÂ STOPÂ Alert",Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’")
stopstringÂ Â Â Â Â =Â input.string(title="StopÂ AlertÂ Message",Â Â Â defval="STOP",Â Â Â confirm=false,Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’",Â tooltip=ttstopstring)
useexpirealertÂ =Â input(defval=true,Â title="UseÂ EXPIREÂ Alert",Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’")
expirestringÂ Â Â =Â input.string(title="ExpireÂ AlertÂ Message",Â defval="EXPIRE",Â confirm=false,Â group="ğ€ğ‹ğ„ğ‘ğ“Â ğŒğ„ğ’ğ’ğ€ğ†ğ„ğ’",Â tooltip=ttexpirestring)
ifÂ buyfinalÂ andÂ usebuyalert
Â Â Â Â alert(buystring,Â Â Â Â alert.freq_once_per_bar)
ifÂ sellfinalÂ andÂ usesellalert
Â Â Â Â alert(sellstring,Â Â Â alert.freq_once_per_bar)
ifÂ takefinalÂ andÂ usetakealert
Â Â Â Â alert(takestring,Â Â Â alert.freq_once_per_bar)
ifÂ stopfinalÂ andÂ usestopalert
Â Â Â Â alert(stopstring,Â Â Â alert.freq_once_per_bar)
ifÂ expirefinalÂ andÂ useexpirealert
Â Â Â Â alert(expirestring,Â alert.freq_once_per_bar)
//BOTÂ Instructions//////////////////////////////////////////////////////////////
//InÂ theÂ IndicatorÂ SettingÂ InputsÂ Tab,Â doÂ theÂ following...
//FormatÂ yourÂ 3CommasÂ messagesÂ toÂ workÂ withÂ pineÂ script.
//ReplaceÂ theÂ "BUY"Â messageÂ withÂ yourÂ 3CommasÂ "DealÂ Start"Â message.
//ReplaceÂ theÂ "SELL"Â andÂ "STOP"Â messagesÂ withÂ yourÂ 3CommasÂ "DealÂ Close"Â message.
//InÂ theÂ AlertÂ Settings,Â doÂ theÂ following...
//ConditionÂ =Â "ğ‰ğ”ğˆğ‚ğ˜Â ğ“ğ‘ğ„ğğƒ"Â andÂ "alert()Â functionÂ callsÂ only".
//ExpirationÂ timeÂ =Â MaximumÂ timeÂ possible.
//AlertÂ actionsÂ =Â WebhookÂ URLÂ (providedÂ byÂ 3Commas)
//3CommasÂ BOTÂ willÂ receiveÂ theÂ messagesÂ andÂ initiateÂ tradesÂ accordingly.
Expand (197 lines)