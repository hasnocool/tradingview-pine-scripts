Script Name: Risk to Reward - FIXED SL Backtester
Author: TZack88
Description: Don't know how to code? No problem! TradingView is an excellent platform for you.  âœ… âœ…

If you have an indicator that you want to backtest using a risk-to-reward ratio or fixed take profit/stop loss levels, then the  Risk to Reward - FIXED SL Backtester  script is the perfect solution for you.

introducing  Risk to Reward - FIXED SL Backtester  Script which will...
PineScript code:

Pine Scriptâ„¢ strategy
Risk to Reward - FIXED SL Backtester
Copy code
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
//Â ThisÂ sourceÂ codeÂ isÂ subjectÂ toÂ theÂ termsÂ ofÂ theÂ MozillaÂ PublicÂ LicenseÂ 2.0Â atÂ https://mozilla.org/MPL/2.0/
//Â Â©Â TZack88
//@version=5
strategy(title='RRÂ -Â FIXEDÂ SLÂ Backtester',Â shorttitle='ZCryptoÂ Backtester',overlay=true,pyramiding=1,Â initial_capital=10000,
Â Â Â commission_type=strategy.commission.percent,Â commission_value=0.075,default_qty_valueÂ =Â 33,Â default_qty_typeÂ =Â strategy.percent_of_equity)
Â Â 
varÂ floatÂ slValÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â 0.0
floatÂ longTPÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â na
varÂ floatÂ SLÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â na
floatÂ BreakevenTPÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â na
floatÂ BreakevenSLÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â na
varÂ floatÂ TPlongÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â na
deal_start_conditionÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â false
varÂ floatÂ long_sl_levelÂ Â Â Â Â Â Â Â Â Â Â Â Â =Â naÂ 
colorÂ bgrayÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â color.rgb(128,Â 223,Â 236,Â 81)
colorÂ WHITEÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â color.rgb(210,Â 210,Â 210)
colorÂ redÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â color.rgb(163,Â 46,Â 46,Â 29)
colorÂ whiteÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â color.rgb(248,Â 248,Â 248,Â 14)
colorÂ oliveÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â color.olive
colorÂ blueÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â color.rgb(23,Â 43,Â 77)
colorÂ GreenÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â color.rgb(10,Â 218,Â 103,Â 34)
stringÂ coreÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â Â "âÂ MainÂ CoreÂ SettingsÂ ğŸ”¸"
stringÂ BreakeevenÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â Â "âÂ BreakevenÂ SettingsÂ ğŸ”¸"Â 
stringÂ SLZ2Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â Â "âÂ TP/SLÂ (Â RiskÂ SystemÂ )Â ğŸ”¸"
stringÂ RRSÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â Â "âÂ RiskÂ toÂ RewardÂ ğŸ”¸"
stringÂ FTPSÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â Â "âÂ FixedÂ TPÂ &Â SLÂ ğŸ”¸"
stringÂ BESÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â Â "âÂ BreakEvenÂ SettingsÂ ğŸ”¸"
floatÂ smmaÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â ta.sma(low,14)
stringÂ SLZ2TOOLÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â "SelectÂ WhichÂ riskÂ systemÂ youÂ wannaÂ useÂ ?!Â RiskÂ toÂ RewardÂ orÂ fixedÂ system"
stringÂ RRTÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â "YourÂ RiskÂ toÂ RewardÂ RatioÂ ?Â 2:1Â thenÂ putÂ 2"
stringÂ _tooltip3Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â "SelectÂ externalÂ indicatorÂ plot"
stringÂ SLSelectÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â "SelectÂ theÂ StoplossÂ Method"
floatÂ external_indicatorÂ Â Â Â Â Â Â Â Â Â Â Â =Â input.source(defval=close,Â title='ExternalÂ indicatorâ€„â€…â€…â€„â€„â€…â€„â€„â€…',Â group=core,Â tooltip=_tooltip3,inlineÂ =Â "00")
floatÂ deal_start_valueÂ Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.int(defval=100,Â title='ExternalÂ Valueâ€„â€…â€…â€„â€…â€…â€„â€…â€…â€…â€„â€„â€„â€„â€…',Â group=core,Â tooltip="PlotÂ Value",inlineÂ =Â "01")
boolÂ RisktypeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.string('RiskÂ ToÂ Reward',Â titleÂ =Â 'â€„â€…â€„ğŸŒ€Â RiskÂ Type',group=SLZ2,inlineÂ =Â "000",optionsÂ =Â ['RiskÂ ToÂ Reward',Â 'FixedÂ TPÂ &Â SL'],tooltipÂ =Â SLZ2TOOL)Â ==Â 'RiskÂ ToÂ Reward'
floatÂ RRTPÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.float(1.5,Â minval=0,stepÂ =Â 0.1,title="RiskÂ ToÂ RewardÂ Ratio",group=RRS,inlineÂ =Â "01",tooltipÂ =Â RRT)
stringÂ stoplossÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.string("ATRÂ SL",Â title="â€„â€…â€„â¬‡ï¸Â StoplossÂ TypeÂ ",Â options=["ATRÂ SL",Â "PivotÂ low",Â "VWAPÂ SL"],Â group=RRS,inlineÂ =Â "02",tooltipÂ =Â SLSelect)
floatÂ ATRSLÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.float(1.4,"â€„â€…â€„â€„â€…â€„â€…â€…â€„ATRÂ Factorâ€…â€„â€„â€…â€„â€„â€…â€„â€„â€„â€„",stepÂ =Â 0.1,groupÂ =Â RRS,inlineÂ =Â "03",tooltipÂ =Â "OnlyÂ usedÂ withÂ ATRÂ SL")
intÂ LBÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.int(8,Â minval=0,title="â€„â€…â€„â€…â€„â€…â€„â€…â€„PivotÂ Lookbackâ€…â€„â€„â€…â€„",group=RRS,inlineÂ =Â "04",tooltipÂ =Â "looksÂ forÂ lowerÂ lowÂ ,OnlyÂ usedÂ withÂ PivotÂ Low")
floatÂ VWAPSLÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.float(2.5,"â€„â€„â€„â€…â€„â€…â€…â€…â€„VwapÂ Multiplierâ€…â€…â€„â€„",stepÂ =Â 0.1,group=RRS,inlineÂ =Â "05",tooltipÂ =Â "GetsÂ theÂ SMMAÂ valueÂ ,OnlyÂ usedÂ withÂ SMMAÂ SL")
floatÂ FixedTPÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.float(1.5,Â minval=0,stepÂ =Â 0.1,title="FixedÂ TP",group=FTPS,inlineÂ =Â "01")Â /Â 100
floatÂ FixedSLÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.float(1.5,Â minval=0,stepÂ =Â 0.1,title="FixedÂ SL",group=FTPS,inlineÂ =Â "01")Â /Â 100
boolÂ breakonÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.bool(true,"BreakEvenÂ ?"Â ,groupÂ =Â BES,Â inline="06",tooltipÂ =Â "BreakevenÂ w")
floatÂ breakRRÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.float(1.0,Â "â€„â€„Â â€„â€„Â RiskÂ ToÂ RewardÂ Ratio",stepÂ =Â 0.1,Â groupÂ =Â BES,Â inline="07")
floatÂ BEperÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.float(0.1,Â "â€„â€„â€„â€„â€„â€„PercentÂ AboveÂ Entry",stepÂ =Â 0.1,Â groupÂ =Â BES,Â inline="08",tooltip="MUSTÂ beÂ higherÂ thanÂ '0'.Â ThisÂ inputÂ frontÂ loadsÂ theÂ newÂ breakevenÂ stopÂ lossÂ soÂ thatÂ itÂ isÂ actuallyÂ inÂ profit.")/100
deal_start_conditionÂ :=Â ifÂ external_indicatorÂ ==Â deal_start_value
Â Â Â Â true
//-----SLÂ coreÂ calculation-----{
x2Â =Â lowÂ -Â ta.rma(ta.tr(true),Â 14)Â *Â ATRSL
stopLongÂ =Â Â ta.lowest(low,LB)
vwapÂ =Â math.sum(ta.vwap(ta.tr(true)),14)Â *Â volume
volumzÂ =Â math.sum(volume,14)
atr_vwap_volumeÂ =Â math.abs(vwapÂ /Â volumz)
longstoplossÂ =Â lowÂ -Â atr_vwap_volumeÂ *Â VWAPSL
//}
//Â LetsÂ getÂ theÂ SLÂ andÂ returnÂ itÂ 
my_stop()Â =>
Â Â Â Â switchÂ stoploss
Â Â Â Â Â Â Â Â "ATRÂ SL"Â =>Â x2
Â Â Â Â Â Â Â Â "PivotÂ low"Â =>Â stopLong
Â Â Â Â Â Â Â Â "SMMAÂ SL"Â =>Â longstoploss
slÂ =Â RisktypeÂ ?Â my_stop()Â :Â closeÂ Â *Â (1Â -Â FixedSL)
//Â letsÂ setÂ theÂ SLÂ ,Â TPÂ Values
ifÂ deal_start_conditionÂ andÂ strategy.position_sizeÂ ==Â 0
Â Â Â Â slVal:=Â sl
else
Â Â Â Â slVal:=Â slValÂ Â Â Â 
longDiffSLÂ =Â math.abs(closeÂ -Â slVal)
longTPÂ :=Â deal_start_conditionÂ andÂ strategy.position_sizeÂ ==Â 0Â ?Â RisktypeÂ ?Â closeÂ +Â (RRTPÂ *Â longDiffSL)Â :Â closeÂ *Â (1Â +Â FixedTP)Â :Â longTP[1]
//Â --Â BacktestÂ DateÂ ?!Â {
limit_date_rangeÂ =Â input.bool(title='LimitÂ DateÂ Range',Â defval=true,Â group='BacktestÂ dateÂ range')
start_timeÂ Â =Â input.time(defval=timestamp('01Â AugÂ 2022Â 00:00Â +0000'),Â title='StartÂ Time',Â group='BacktestÂ dateÂ range')
end_timeÂ Â Â Â =Â input.time(defval=timestamp('31Â DecÂ 2025Â 00:00Â +0000'),Â title='EndÂ Time',Â group='BacktestÂ dateÂ range')
in_date_rangeÂ =Â true
ifÂ limit_date_range
Â Â Â Â in_date_rangeÂ :=Â timeÂ >=Â start_timeÂ andÂ timeÂ <=Â end_time
Â Â Â Â 
else
Â Â Â Â in_date_rangeÂ :=Â true
//--Â }
longConditionÂ =Â (deal_start_condition==Â true)Â andÂ strategy.position_sizeÂ ==Â 0
//Breakeven
BreakevenTPÂ :=Â longConditionÂ ?Â closeÂ +Â (breakRRÂ *Â longDiffSL)Â :Â BreakevenTP[1]
BREAKPLOTÂ =Â strategy.position_sizeÂ >Â 0Â ?Â BreakevenTPÂ :Â na
BreakevenSLÂ :=Â strategy.position_sizeÂ >Â 0Â ?Â strategy.position_avg_priceÂ *Â (1Â +Â BEper)Â :na
long_tp_hitÂ =Â closeÂ >=Â BreakevenTPÂ orÂ high>=Â BreakevenTP
long_sl_levelÂ :=Â longConditionÂ Â ?Â slValÂ :Â long_tp_hitÂ ?Â BreakevenSL:Â long_sl_level[1]
ifÂ (in_date_rangeÂ andÂ longCondition)
Â Â Â Â strategy.entry("LONG",Â strategy.longÂ )Â Â Â 
strategy.exit("LongÂ 3","LONG",Â 
Â Â Â Â Â limit=longTP,Â Â 
Â Â Â Â Â stop=(breakonÂ ?Â long_sl_levelÂ :Â slVal),
Â Â Â Â Â comment_profitÂ =Â "TPÂ HIT",
Â Â Â Â Â comment_lossÂ =Â breakonÂ ?Â "BEÂ Close"Â :Â "Loss"
Â Â Â Â Â )Â Â 
Â Â Â Â 
//Â PLOTS
SLplotÂ =Â Â strategy.position_sizeÂ >Â 0Â ?Â slValÂ :Â na
SSLÂ =Â plot(SLplot,Â title='LONGÂ STOPÂ LOSS',Â linewidth=2,Â style=plot.style_linebr,Â color=red)
longPlotTPÂ =Â Â strategy.position_sizeÂ >Â 0Â ?Â longTPÂ :Â na
TTPÂ =Â plot(longPlotTP,Â title='LONGÂ TAKEÂ PROFIT',Â linewidth=2,Â style=plot.style_linebr,Â color=Green)
avgÂ =Â plot(Â strategy.position_avg_price,Â styleÂ =Â plot.style_linebr,color=WHITEÂ )
BREKEVENLINEÂ =Â strategy.position_sizeÂ >Â 0Â ?Â long_sl_levelÂ :Â naÂ 
plot(breakonÂ ?Â BREKEVENLINEÂ :Â na,Â 'AVGÂ Price',color=color.white,Â style=plot.style_linebr,editableÂ =Â false,linewidthÂ =Â 2)
fill(TTP,Â avg,Â colorÂ =Â color.new(Green,80))
fill(avg,Â SSL,Â colorÂ =color.new(red,80))
Expand (133 lines)