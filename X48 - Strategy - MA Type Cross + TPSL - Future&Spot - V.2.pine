Script Name: X48 - Strategy - MA Type Cross + TPSL - Future&Spot - V.2
Author: X4815162342
Description: Thank You For Open Source Code, This Strategy Ref. By 1.Simple Strategy Like MA Crossover For Long/Short or Spot Trade, 2. CDC Action Zone V.2 for BarPaint
This Strategy Mixing With MA Crossover Strategy and BarPaint By CDC Action Zone and TP/SL by Varbara 

 ### How To Use Strategy : Setting EMA/SMA Crossover EMA/SMA, Any Value If You Want 
 
 For Long Position :...
PineScript code:

Pine Scriptâ„¢ strategy
X48 - Strategy | MA Type Cross + TPSL | Future&Spot | V.2
Copy code
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
//Â ThisÂ sourceÂ codeÂ isÂ subjectÂ toÂ theÂ termsÂ ofÂ theÂ MozillaÂ PublicÂ LicenseÂ 2.0Â atÂ https://mozilla.org/MPL/2.0/
//Â Â©Â X4815162342
//Â ThankÂ YouÂ ForÂ OpenÂ SourceÂ Code,Â ThisÂ StrategyÂ Ref.Â ByÂ 1.SimpleÂ StrategyÂ LikeÂ MAÂ CrossoverÂ ForÂ Long/ShortÂ orÂ SpotÂ Trade,Â 2.Â CDCÂ ActionÂ ZoneÂ V.2Â forÂ BarPaint
//Â ThisÂ StrategyÂ MixingÂ WithÂ MAÂ CrossoverÂ StrategyÂ andÂ BarPaintÂ ByÂ CDCÂ ActionÂ ZoneÂ andÂ TP/SLÂ byÂ Varbara
//Â andÂ ThanksÂ ForÂ OriginalÂ SourceÂ SwingÂ H/LÂ byÂ @millerrh
//Â HowÂ ToÂ UseÂ StrategyÂ :Â SettingÂ EMA/SMAÂ CrossoverÂ EMA/SMA,Â AnyÂ ValueÂ IfÂ YouÂ Want
//Â ForÂ LongÂ PositionÂ :Â CrossÂ Up
//Â ForÂ ShortÂ PositionÂ :Â CrossÂ Down
//Â CanÂ UseÂ WithÂ SpotÂ TradeÂ :Â CrossÂ UpÂ =Â Buy,Â CrossÂ DownÂ =Â Sell
//Â InÂ Setting
//Â IntitialÂ CapitalÂ =Â Ex.Â 200
//Â OrderÂ SizeÂ =Â ShouldÂ BeÂ MoneyÂ ManagementÂ NotÂ UseÂ 100%Â ofÂ CapitalÂ Ex.Â 10%Â ofÂ CapitalÂ (200$)Â =Â OrderÂ SizeÂ 20$
//Â StopLossÂ andÂ TakeÂ ProfitÂ =Â IfÂ YouÂ RunÂ TrendÂ TFÂ 4H+Â orÂ 1D+Â YouÂ CanÂ ChangeÂ TP%Â =Â 1,000%Â forÂ nonlimitÂ andÂ StopÂ LossÂ 5Â -Â 20%Â fromÂ yourÂ orderÂ size
//Â Â Ex.Â StoplossÂ 15%Â =Â OrderSizeÂ /Â 100Â xÂ %SLÂ =Â 20$/100Â xÂ 15%Â =Â 3$Â LossÂ fromÂ orderÂ sizeÂ 20$Â (ifÂ youÂ notÂ setÂ stopÂ loss.)
//Â BaseÂ CurrencyÂ =Â (YourÂ Currency)Â #Â Ex.Â USD
//Â CommissionÂ =Â (YourÂ TradingÂ Fee)Â #Â Ex.Â FutureÂ FeeÂ CanÂ CheckÂ AtÂ BinanceÂ FeeÂ RateÂ >Â https://www.binance.com/en/fee/scheduleÂ >Â ChooseÂ YourÂ FeeÂ Type,Â Ex.Â USDÂ MÂ FutureÂ (RegularÂ User)Â =Â 0.02Â (Maker),Â 0.04Â (Taker)
//Â CommissionÂ SymbolÂ TypeÂ =Â %Â Â Â Â Â #Â (Ref.Â ByÂ BinanceÂ FeeÂ Rate)
//Â DefaultÂ SettingÂ It'sÂ RealisticÂ FromÂ NormalÂ LifeÂ Ex.Â CapitalÂ 200$Â /Â OrdersizeÂ 20$Â (10%)/Â CommissionÂ 0.1%Â (Buy+Sell)Â /Â SlippageÂ =Â 2Â /Â TPÂ =Â 1000%Â (nonlimit)Â /Â SLÂ =Â 15%/OrderSize
//Â LowÂ RiskÂ ButÂ HighÂ Return,Â GoodÂ Luck
//Â ifÂ youÂ wannaÂ tryÂ myÂ botÂ autoÂ tradeÂ X48-3in1-botÂ :Â ContactÂ MyÂ LineÂ IDÂ :Â x4815x
//@version=5
strategy('X48Â -Â StrategyÂ |Â MAÂ MultiÂ TypeÂ CrossÂ +Â TPSLÂ +Â SwingÂ +Â Surfing&Diving|Â Future&SpotÂ |Â V.3.6',Â overlay=true,Â default_qty_type=strategy.cash,Â default_qty_value=20,Â initial_capital=200,Â currency=currency.USD,Â commission_value=0.1,Â slippageÂ =Â 0)
//Â ğŸ“ŒğŸ“ŒÂ SpotÂ ModeÂ ğŸ“ŒğŸ“Œ
SMODEÂ =Â input.bool(title="SPOTÂ MODE",Â defval=false,Â groupÂ =Â '=Â SPOTÂ SETTINGÂ =',Â tooltipÂ =Â 'SPOTÂ =Â DisableÂ ShortÂ Position')
///////////Â NormalÂ SettingÂ ////////////////
srcstrategyÂ =Â input(close,Â title='SourceÂ MultiÂ MA',Â groupÂ =Â '=Â MultiÂ MAÂ SETTINGÂ =',Â tooltipÂ =Â 'NormalÂ LineÂ =Â CloseÂ \nSmoothÂ LineÂ =Â ohlc4')
/////////////Â EMA/SMAÂ SETTINGÂ /////////////
pricestrategyÂ =Â request.security(syminfo.tickerid,Â timeframe.period,Â srcstrategy)
fastSWÂ =Â input.bool(title='ShowÂ FastÂ MAÂ Line',Â defval=true,Â groupÂ =Â '=Â MultiÂ MAÂ SETTINGÂ =')
slowSWÂ =Â input.bool(title='ShowÂ SlowÂ MAÂ Line',Â defval=true,Â groupÂ =Â '=Â MultiÂ MAÂ SETTINGÂ =')
ma1strategyÂ =Â input(18,Â title='FastÂ MAÂ Length',Â groupÂ =Â '=Â MultiÂ MAÂ SETTINGÂ =')
type1strategyÂ =Â input.string('EMA',Â 'FastÂ MAÂ Type',Â options=['SMA',Â 'EMA',Â 'WMA',Â 'HMA',Â 'RMA',Â 'VWMA'],Â groupÂ =Â '=Â MultiÂ MAÂ SETTINGÂ =',Â tooltipÂ =Â 'SMAÂ /Â EMAÂ /Â WMAÂ /Â HMAÂ /Â RMAÂ /Â VWMA')
MA2_MODEÂ =Â input.bool(title="MAÂ MIDDLEÂ MODE",Â defval=false,Â groupÂ =Â '=Â MIDDLEÂ 3MAÂ SETTINGÂ =',Â tooltipÂ =Â 'StrategyÂ Is\nMAÂ FastÂ >Â MAÂ SlowÂ =Â Long\nEMAÂ FastÂ <Â MAÂ MidÂ =Â Short')
ma2strategyÂ =Â input(24,Â title='MiddleÂ MAÂ Length',Â groupÂ =Â '=Â MIDDLEÂ 3MAÂ SETTINGÂ =')
type2strategyÂ =Â input.string('EMA',Â 'MiddleÂ MAÂ Type',Â options=['SMA',Â 'EMA',Â 'WMA',Â 'HMA',Â 'RMA',Â 'VWMA'],Â groupÂ =Â '=Â MIDDLEÂ 3MAÂ SETTINGÂ =',Â tooltipÂ =Â 'SMAÂ /Â EMAÂ /Â WMAÂ /Â HMAÂ /Â RMAÂ /Â VWMA')
ma3strategyÂ =Â input(34,Â title='SlowÂ MAÂ Length',Â groupÂ =Â '=Â MultiÂ MAÂ SETTINGÂ =')
type3strategyÂ =Â input.string('EMA',Â 'SlowÂ MAÂ Type',Â options=['SMA',Â 'EMA',Â 'WMA',Â 'HMA',Â 'RMA',Â 'VWMA'],Â groupÂ =Â '=Â MultiÂ MAÂ SETTINGÂ =',Â tooltipÂ =Â 'SMAÂ /Â EMAÂ /Â WMAÂ /Â HMAÂ /Â RMAÂ /Â VWMA')
price1strategyÂ =Â switchÂ type1strategy
Â Â Â Â "EMA"Â =>Â ta.ema(pricestrategy,Â ma1strategy)
Â Â Â Â "SMA"Â =>Â ta.sma(pricestrategy,Â ma1strategy)
Â Â Â Â "WMA"Â =>Â ta.wma(pricestrategy,Â ma1strategy)
Â Â Â Â "HMA"Â =>Â ta.hma(pricestrategy,Â ma1strategy)
Â Â Â Â "RMA"Â =>Â ta.rma(pricestrategy,Â ma1strategy)
Â Â Â Â "VWMA"Â =>Â ta.vwma(pricestrategy,Â ma1strategy)
Â Â Â Â 
price2strategyÂ =Â switchÂ type2strategy
Â Â Â Â "EMA"Â =>Â ta.ema(pricestrategy,Â ma2strategy)
Â Â Â Â "SMA"Â =>Â ta.sma(pricestrategy,Â ma2strategy)
Â Â Â Â "WMA"Â =>Â ta.wma(pricestrategy,Â ma2strategy)
Â Â Â Â "HMA"Â =>Â ta.hma(pricestrategy,Â ma2strategy)
Â Â Â Â "RMA"Â =>Â ta.rma(pricestrategy,Â ma2strategy)
Â Â Â Â "VWMA"Â =>Â ta.vwma(pricestrategy,Â ma2strategy)
Â Â Â Â 
price3strategyÂ =Â switchÂ type3strategy
Â Â Â Â "EMA"Â =>Â ta.ema(pricestrategy,Â ma3strategy)
Â Â Â Â "SMA"Â =>Â ta.sma(pricestrategy,Â ma3strategy)
Â Â Â Â "WMA"Â =>Â ta.wma(pricestrategy,Â ma3strategy)
Â Â Â Â "HMA"Â =>Â ta.hma(pricestrategy,Â ma3strategy)
Â Â Â Â "RMA"Â =>Â ta.rma(pricestrategy,Â ma3strategy)
Â Â Â Â "VWMA"Â =>Â ta.vwma(pricestrategy,Â ma3strategy)
/////////////////////////////////////////////////////////////////////////////////////////////////////
Text_Alert_FutureÂ =Â '{{strategy.order.alert_message}}'
copy_FuÂ =Â input(Â defval=Â Text_Alert_FutureÂ ,Â Â Â Â title="AlertÂ MessageÂ forÂ BOT",Â inlineÂ =Â '00'Â Â ,groupÂ =Â 'â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It'Â ,tooltipÂ =Â 'AlertÂ ForÂ X48-BOTÂ >Â CopyÂ andÂ PasteÂ ToÂ AlertÂ Function')
passphraseÂ =Â input.string(defval='1234',Â titleÂ ='BotÂ Pass',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â 'PassphraseÂ MustÂ BeÂ SameÂ asÂ X48-BOT')
leveragexÂ Â =Â input.int(125,title='leverage',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',tooltip='"NOTHING"Â toÂ doÂ withÂ PositionÂ sizeÂ ForÂ CommandÂ ToÂ X48-BOTÂ Only',minval=1)
longcommandÂ =Â input.string(defval='AutoLong',Â titleÂ =Â 'BotÂ LongÂ Command',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â '1.OpenLong\n2.AutoLong\n***IfÂ AutoLongÂ =Â Close(100%)Â FirstÂ >Â OpenÂ LongÂ PositionÂ Auto')
shortcommandÂ =Â input.string(defval='AutoShort',Â titleÂ =Â 'BotÂ ShortÂ Command',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â '1.OpenShort\n2.AutoShort\n***IfÂ AutoShortÂ =Â Close(100%)Â FirstÂ >Â OpenÂ ShortÂ PositionÂ Auto')
markettypeÂ =Â input.string(defval='bnfuture',Â titleÂ =Â 'Future/SpotÂ Command',group='â•Â BotÂ SettingÂ â•Â \nÂ >>Â IfÂ YouÂ DontÂ UseÂ BotÂ JustÂ PassÂ It',Â tooltipÂ =Â '1.Â bnfutureÂ =Â FUTUREÂ MODE\n2.Â bnspotÂ =Â SPOTÂ MODE\nÂ 3.bncomboÂ =Â EZÂ 2in1Â Order')
////////////////Â StrategyÂ AlertÂ ForÂ X4815162342Â BOTÂ //////////////////////
////////Â ForÂ UseÂ BotÂ CanÂ ChangeÂ ThisÂ CommandÂ ByÂ YourÂ SelfÂ /////////////////////
stringÂ Alert_OpenLongÂ Â Â Â Â Â Â =Â '{"ex":"'+markettype+'","side":Â "'+longcommand+'",Â "amount":Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
stringÂ Alert_OpenShortÂ Â Â Â Â Â =Â '{"ex":"'+markettype+'","side":Â "'+shortcommand+'",Â "amount":Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//stringÂ Alert_LongTPÂ Â Â Â Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseLong",Â "amount":Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//stringÂ Alert_ShortTPÂ Â Â Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseShort",Â "amount":Â "@{{strategy.order.contracts}}",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//varÂ message_closelongÂ Â Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseLong",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//varÂ message_closeshortÂ Â Â Â Â Â =Â '{"ex":"bnfuture","side":Â "CloseShort",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
stringÂ Alert_StopLosslongÂ Â Â =Â '{"ex":"'+markettype+'","side":Â "CloseLong",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
stringÂ Alert_StopLossshortÂ Â =Â '{"ex":"'+markettype+'","side":Â "CloseShort",Â "amount":Â "%100",Â "symbol":Â "{{ticker}}",Â "passphrase":Â "'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////Â Â 
RSI_MODEÂ =Â input.bool(title="RSIÂ MODE",Â defval=false,Â groupÂ =Â '=Â RSIÂ SETTINGÂ >>Â COMFIRMÂ RSIÂ BEFOREÂ OPENÂ POSITIONÂ =',Â tooltipÂ =Â 'IfÂ ModeÂ OnÂ =Â UseÂ RSIÂ StrategyÂ WithÂ LongÂ andÂ Short\nÂ >>Â RSIÂ ConfirmÂ BeforeÂ OpenÂ Position')
//ifÂ RSI_MODEÂ ==Â true
RSILengthÂ =Â input(14,Â title='RSIÂ Length',Â groupÂ =Â '=Â RSIÂ SETTINGÂ >>Â PLOTÂ RSIÂ SIGNALÂ OBÂ OSÂ =')
OverBoughtÂ =Â input(70,Â title='RSIÂ OB',Â groupÂ =Â '=Â RSIÂ SETTINGÂ >>Â PLOTÂ RSIÂ SIGNALÂ OBÂ OSÂ =',Â tooltipÂ =Â 'LilÂ CrossÂ Symbol')
OverSoldÂ =Â input(30,Â title='RSIÂ OS',Â groupÂ =Â '=Â RSIÂ SETTINGÂ >>Â PLOTÂ RSIÂ SIGNALÂ OBÂ OSÂ =',Â tooltipÂ =Â 'LilÂ DiamondÂ Symbol')
vrsiÂ =Â ta.rsi(srcstrategy,Â RSILength)
RSIUPÂ =Â ta.crossover(vrsi,Â OverBought)
RSIDOWNÂ =Â ta.crossunder(vrsi,Â OverSold)
plotshape(RSI_MODEÂ ?Â RSIUPÂ :Â na,Â title='RSIUP',Â textÂ =Â 'â°',Â color=color.new(color.yellow,Â 100),Â style=shape.circle,Â location=location.belowbar,Â size=size.tiny)Â Â //plotÂ forÂ buyÂ icon
plotshape(RSI_MODEÂ ?Â RSIDOWNÂ :Â na,Â title='RSIDOWN',Â textÂ =Â 'â˜€ï¸',Â color=color.new(color.red,Â 100),Â style=shape.circle,Â location=location.abovebar,Â size=size.tiny)Â Â //plotÂ forÂ buyÂ icon
////////////////////////////////////////////////////////////////////////////////////////////////////////////////Â Â 
MACD_MODE_SIG=Â input.bool(title="MACDÂ MODEÂ =Â MACDÂ CrossÂ Signal",Â defval=false,Â groupÂ =Â '=Â MACDÂ SETTINGÂ =',Â tooltipÂ =Â 'IfÂ ModeÂ OnÂ =Â UseÂ MACDÂ StrategyÂ forÂ SignalÂ WhenÂ CrossÂ UpÂ andÂ CrossÂ Down')
//ifÂ MACD_MODE_SIGÂ ==Â true
MACDfastLengthÂ =Â input(12,Â title='MACDÂ Fast',Â groupÂ =Â '=Â MACDÂ SETTINGÂ =')
MACDslowlengthÂ =Â input(26,Â title='MACDÂ Slow',Â groupÂ =Â '=Â MACDÂ SETTINGÂ =')
MACDLengthÂ =Â input(18,Â title='MACDÂ Length',Â groupÂ =Â '=Â MACDÂ SETTINGÂ =')
MACDÂ =Â ta.ema(close,Â MACDfastLength)Â -Â ta.ema(close,Â MACDslowlength)
aMACDÂ =Â ta.ema(MACD,Â MACDLength)
deltaÂ =Â MACDÂ -Â aMACD
macdTPlÂ =Â (ta.crossover(delta,Â 0))
macdTPsÂ =Â (ta.crossunder(delta,Â 0))
plotshape(MACD_MODE_SIGÂ ?Â macdTPlÂ :Â na,Â title='macdTPl',Â textÂ =Â 'ğŸ’',Â color=color.new(color.yellow,Â 100),Â style=shape.circle,Â location=location.belowbar,Â size=size.tiny)Â Â //plotÂ forÂ buyÂ icon
plotshape(MACD_MODE_SIGÂ ?Â macdTPsÂ :Â na,Â title='macdTPs',Â textÂ =Â 'ğŸ’',Â color=color.new(color.red,Â 100),Â style=shape.circle,Â location=location.abovebar,Â size=size.tiny)Â Â //plotÂ forÂ buyÂ icon
////////////////////////////////////////////////////////////////////////////////////////////////
/////////Â SurfingÂ andÂ DivingÂ /////////////
SURF_DIVE_MODEÂ =Â input.bool(title="SURFING&DIVINGÂ MODE",Â defval=false,Â groupÂ =Â '=Â SURF&DIVINGÂ SETTINGÂ =',Â tooltipÂ =Â 'HowÂ ToÂ Use\n3Â DotÂ WavesÂ CrossUpÂ PurpleÂ LineÂ =Â BullishÂ Trend\n3Â DotÂ WavesÂ CrossDownÂ PurpleÂ LineÂ =Â BearishÂ Trend\n\nBigÂ BlueÂ DotÂ isÂ SurfingÂ Zone\nCandleÂ PriceÂ CloseÂ >Â SurfingÂ ZoneÂ =Â LilÂ Bullish\nCandleÂ PriceÂ ClsoeÂ <Â SurfingÂ ZoneÂ =Â LilÂ Bearish')
surfing_21Â =Â ta.ema(close,21)
diving_144Â =Â ta.ema(close,144)
diving_233Â =Â ta.ema(close,233)
surfing_hÂ =Â ta.sma(high,34)
surfing_cÂ =Â ta.sma(close,34)
surfing_lÂ =Â ta.sma(low,34)
surfingupÂ =Â ta.crossover(close,surfing_21)
surfingdownÂ =Â ta.crossunder(close,surfing_21)
showSurfÂ =Â input(false,Â title='ShowÂ SurfingÂ &Â DivingÂ Signal',Â groupÂ =Â '=Â SURF&DIVINGÂ SETTINGÂ =',Â tooltipÂ =Â 'PlotÂ SymbolÂ ofÂ LilÂ TrendÂ ByÂ SurfingÂ Man')
plotshowSurfÂ =Â SURF_DIVE_MODEÂ ==Â trueÂ ?Â showSurfÂ :Â na
plotshape(showSurfÂ ?Â surfingupÂ :Â na,'SurfingUp',locationÂ =Â location.belowbar,textÂ =Â 'ğŸ„â€â™‚ï¸')
plotshape(showSurfÂ ?Â surfingdownÂ :Â na,'SurfingDown',locationÂ =Â location.abovebar,textÂ =Â 'ğŸ„')
plot(SURF_DIVE_MODEÂ ?Â surfing_21Â :Â na,Â 'surfing_21',Â color=color.new(#6EB0FF,20),Â linewidthÂ =Â 1,Â style=plot.style_stepline_diamond)
plot(SURF_DIVE_MODEÂ ?Â surfing_hÂ :Â na,Â 'surfing_h',Â color=color.aqua,Â linewidthÂ =Â 1,Â style=plot.style_circles)
plot(SURF_DIVE_MODEÂ ?Â surfing_cÂ :Â na,Â 'surfing_c',Â color=color.silver,Â linewidthÂ =Â 1,Â style=plot.style_circles)
plot(SURF_DIVE_MODEÂ ?Â surfing_lÂ :Â na,Â 'surfing_l',Â color=color.blue,Â linewidthÂ =Â 1,Â style=plot.style_circles)
plot(SURF_DIVE_MODEÂ ?Â diving_144Â :Â na,Â 'diving_144',Â color=color.purple,Â linewidthÂ =Â 2,Â style=plot.style_line)
plot(SURF_DIVE_MODEÂ ?Â diving_233Â :Â na,Â 'diving_233',Â color=#FF00FF,Â linewidthÂ =Â 2,Â style=plot.style_line)
/////////////Â TakeÂ ProfitÂ andÂ StopÂ LossÂ SettingÂ ////////////////////
tpsl(percent)Â =>
Â Â Â Â strategy.position_avg_priceÂ *Â percentÂ /Â 100Â /Â syminfo.mintick
modeÂ =Â input.bool(title="ModeÂ AUTOÂ TP/SL",Â defval=true,Â group="=Â AUTOÂ TP/SLÂ =",Â tooltipÂ =Â 'IfÂ ModeÂ OnÂ =Â UseÂ TP/SL\nIfÂ ModeÂ OffÂ =Â TurnÂ OffÂ TP/SLÂ Effect\nTPÂ =Â 1000%+Â forÂ nonlimitÂ TPÂ LengthÂ \nSLÂ =Â 1-100%Â ifÂ 100%Â ItsÂ MeanÂ Liq.Â Position')
tp_lÂ =Â tpsl(input.float(0,Â title='TPÂ [LONG]Â %',Â group="=Â AUTOÂ TP/SLÂ =",Â tooltipÂ =Â 'DisableÂ =Â 0Â (nonÂ limitÂ profit)'))
tp_sÂ =Â tpsl(input.float(0,Â title='TPÂ [SHORT]Â %',Â group="=Â AUTOÂ TP/SLÂ =",Â tooltipÂ =Â 'DisableÂ =Â 0Â (nonÂ limitÂ profit)'))
slÂ =Â tpsl(input.float(0,Â title='AutoÂ StopÂ LossÂ %',Â group="=Â AUTOÂ TP/SLÂ =",Â tooltipÂ =Â 'DisableÂ =Â 0Â (nonÂ limitÂ StopÂ Loss)'))
BOTrail_MODEÂ =Â input.bool(defvalÂ =Â false,Â titleÂ =Â "ğŸ…¾ï¸Â CALLBACKÂ TrailingÂ StopÂ Mode",Â groupÂ =Â "=Â AUTOÂ TP/SLÂ =",Â tooltipÂ =Â "BreakOutÂ LengthÂ ForÂ Who'sÂ WantÂ FastÂ TrailingÂ ButÂ ThisÂ LowÂ ProfitÂ ButÂ MoreÂ TimeÂ ForÂ TP\nIt'sÂ CanÂ ComboÂ WithÂ BreakoutÂ andÂ 15m")
lengthBOÂ =Â input.int(title="1ï¸âƒ£Â LengthÂ CallBack",Â minval=1,Â maxval=1000,Â defval=5,Â groupÂ =Â "=Â AUTOÂ TP/SLÂ =")
triling_BOÂ =Â input.float(titleÂ =Â "ğŸ…¾ï¸Â BreakOutÂ TrailingÂ CALLBACKÂ [%]",Â defvalÂ =Â 25,Â minvalÂ =Â 0.01,Â maxvalÂ =Â 999.99,Â groupÂ =Â "=Â AUTOÂ TP/SLÂ =",Â tooltipÂ =Â "BinanceÂ CallbackÂ =Â 5%,Â NowÂ YouÂ CanÂ CustomizeÂ YourÂ CallbackÂ ><")
upBoundÂ =Â ta.highest(high,Â lengthBO)
downBoundÂ =Â ta.lowest(low,Â lengthBO)
SL_LongBOÂ =Â (closeÂ <Â (upBound-((upBound*triling_BO)/100)))
SL_ShortBOÂ =Â (closeÂ >Â (downBound+((downBound*triling_BO)/100)))
calcStopLossPrice(OffsetPts)Â =>
Â Â Â Â ifÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â strategy.position_avg_priceÂ -Â OffsetPtsÂ *Â syminfo.mintick
Â Â Â Â elseÂ ifÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â strategy.position_avg_priceÂ +Â OffsetPtsÂ *Â syminfo.mintick
Â Â Â Â else
Â Â Â Â Â Â Â Â na
calcStopLossL_AlertPrice(OffsetPts)Â =>
Â Â Â Â strategy.position_avg_priceÂ -Â OffsetPtsÂ *Â syminfo.mintick
calcStopLossS_AlertPrice(OffsetPts)Â =>
Â Â Â Â strategy.position_avg_priceÂ +Â OffsetPtsÂ *Â syminfo.mintick
calcTakeProfitPrice(OffsetPts)Â =>
Â Â Â Â ifÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â strategy.position_avg_priceÂ +Â OffsetPtsÂ *Â syminfo.mintick
Â Â Â Â elseÂ ifÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â strategy.position_avg_priceÂ -Â OffsetPtsÂ *Â syminfo.mintick
Â Â Â Â else
Â Â Â Â Â Â Â Â na
calcTakeProfitL_AlertPrice(OffsetPts)Â =>
Â Â Â Â strategy.position_avg_priceÂ +Â OffsetPtsÂ *Â syminfo.mintick
calcTakeProfitS_AlertPrice(OffsetPts)Â =>
Â Â Â Â strategy.position_avg_priceÂ -Â OffsetPtsÂ *Â syminfo.mintick
varÂ stoplossÂ =Â 0.
varÂ stoploss_lÂ =Â 0.
varÂ stoploss_sÂ =Â 0.
varÂ takeprofitÂ =Â 0.
varÂ takeprofit_lÂ =Â 0.
varÂ takeprofit_sÂ =Â 0.
varÂ takeprofit_llÂ =Â 0.
varÂ takeprofit_ssÂ =Â 0.
ifÂ modeÂ ==Â true
Â Â Â Â ifÂ (strategy.position_sizeÂ >Â 0)
Â Â Â Â Â Â Â Â ifÂ slÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â stoplossÂ :=Â calcStopLossPrice(sl)
Â Â Â Â Â Â Â Â Â Â Â Â stoploss_lÂ :=Â stoploss
Â Â Â Â Â Â Â Â elseÂ ifÂ slÂ <=Â 0
Â Â Â Â Â Â Â Â Â Â Â Â stoplossÂ :=Â na
Â Â Â Â Â Â Â Â ifÂ tp_lÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â takeprofitÂ :=Â tp_l
Â Â Â Â Â Â Â Â Â Â Â Â takeprofit_llÂ :=Â closeÂ +Â ((close/100)*tp_l)
Â Â Â Â Â Â Â Â Â Â Â Â //takeprofit_sÂ :=Â na
Â Â Â Â Â Â Â Â elseÂ ifÂ tp_lÂ <=Â 0
Â Â Â Â Â Â Â Â Â Â Â Â takeprofitÂ :=Â na
Â Â Â Â ifÂ (strategy.position_sizeÂ <Â 0)
Â Â Â Â Â Â Â Â ifÂ slÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â stoplossÂ :=Â calcStopLossPrice(sl)
Â Â Â Â Â Â Â Â Â Â Â Â stoploss_sÂ :=Â stoploss
Â Â Â Â Â Â Â Â elseÂ ifÂ slÂ <=Â 0
Â Â Â Â Â Â Â Â Â Â Â Â stoplossÂ :=Â na
Â Â Â Â Â Â Â Â ifÂ tp_sÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â takeprofitÂ :=Â tp_s
Â Â Â Â Â Â Â Â Â Â Â Â takeprofit_ssÂ :=Â closeÂ -Â ((close/100)*tp_s)
Â Â Â Â Â Â Â Â Â Â Â Â //takeprofit_lÂ :=Â na
Â Â Â Â Â Â Â Â elseÂ ifÂ tp_sÂ <=Â 0
Â Â Â Â Â Â Â Â Â Â Â Â takeprofitÂ :=Â na
Â Â Â Â elseÂ ifÂ strategy.position_sizeÂ ==Â 0
Â Â Â Â Â Â Â Â stoplossÂ :=Â na
Â Â Â Â Â Â Â Â takeprofitÂ :=Â na
Â Â Â Â Â Â Â Â //takeprofit_lÂ :=Â calcTakeProfitL_AlertPrice(tp_l)
Â Â Â Â Â Â Â Â //takeprofit_sÂ :=Â calcTakeProfitS_AlertPrice(tp_s)
Â Â Â Â Â Â Â Â //stoploss_lÂ :=Â calcStopLossL_AlertPrice(sl)
Â Â Â Â Â Â Â Â //stoploss_sÂ :=Â calcStopLossS_AlertPrice(sl)
////////////Â INPUTÂ BACKTESTÂ RANGEÂ ////////////////////////////////////////////////////
varÂ stringÂ BTR1Â Â Â Â Â Â Â Â Â =Â 'â•â•â•â•â•â•â•â•Â INPUTÂ BACKTESTÂ TIMEÂ RANGEÂ â•â•â•â•â•â•â•â•'
i_startTimeÂ Â Â Â Â Â Â Â Â Â Â Â Â =Â input.time(defvalÂ =Â timestamp("01Â JanÂ 1945Â 00:00Â +0000"),Â titleÂ =Â "Start",Â inline="timestart",Â group=BTR1,Â tooltipÂ =Â 'StartÂ BacktestÂ YYYY/MM/DD')
i_endTimeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â =Â input.time(defvalÂ =Â timestamp("01Â JanÂ 2074Â 23:59Â +0000"),Â titleÂ =Â "End",Â inline="timeend",Â group=BTR1,Â tooltipÂ =Â 'EndÂ BacktestÂ YYYY/MM/DD')
ifÂ timeÂ >=Â i_startTimeÂ andÂ timeÂ <=Â i_endTime
Â Â Â Â ifÂ MA2_MODEÂ ==Â false
Â Â Â Â Â Â Â Â longConditionÂ =Â ta.crossover(price1strategy,Â price3strategy)
Â Â Â Â Â Â Â Â ifÂ longCondition
Â Â Â Â Â Â Â Â Â Â Â Â strategy.entry('Long',Â strategy.long,Â alert_messageÂ =Â Alert_OpenLong,Â commentÂ =Â "ğŸŒ™")
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â shortConditionÂ =Â ta.crossunder(price1strategy,Â price3strategy)
Â Â Â Â Â Â Â Â ifÂ shortConditionÂ andÂ SMODEÂ ==Â true
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close('Long',Â qty_percentÂ =Â 100,Â commentÂ =Â 'ğŸƒ')
Â Â Â Â Â Â Â Â ifÂ shortConditionÂ andÂ SMODEÂ ==Â false
Â Â Â Â Â Â Â Â Â Â Â Â strategy.entry('Short',Â strategy.short,Â alert_messageÂ =Â Alert_OpenShort,Â commentÂ =Â "ğŸ‘»")
Â Â Â Â 
Â Â Â Â ifÂ MA2_MODEÂ ==Â true
Â Â Â Â Â Â Â Â longConditionÂ =Â ta.crossover(price1strategy,Â price3strategy)
Â Â Â Â Â Â Â Â ifÂ longCondition
Â Â Â Â Â Â Â Â Â Â Â Â strategy.entry('Long',Â strategy.long,Â alert_messageÂ =Â Alert_OpenLong,Â commentÂ =Â "ğŸŒ™")
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â shortConditionÂ =Â ta.crossunder(price1strategy,Â price3strategy)
Â Â Â Â Â Â Â Â StopshortConditionÂ =Â ta.crossunder(price1strategy,Â price2strategy)
Â Â Â Â Â Â Â Â ifÂ StopshortConditionÂ andÂ SMODEÂ ==Â true
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close('Long',Â qty_percentÂ =Â 100,Â commentÂ =Â 'ğŸƒ')
Â Â Â Â Â Â Â Â ifÂ StopshortConditionÂ andÂ SMODEÂ ==Â false
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close('Long',Â qty_percentÂ =Â 100,Â commentÂ =Â 'ğŸƒ')
Â Â Â Â Â Â Â Â ifÂ shortConditionÂ andÂ SMODEÂ ==Â false
Â Â Â Â Â Â Â Â Â Â Â Â strategy.entry('Short',Â strategy.short,Â alert_messageÂ =Â Alert_OpenShort,Â commentÂ =Â "ğŸ‘»")
//////////////////Â StrategyÂ TakeÂ ProfitÂ andÂ StopÂ LossÂ LabelÂ HereÂ ///////////////////
Â Â Â Â //ifÂ modeÂ ==Â true
Â Â Â Â //Â Â Â Â ifÂ (strategy.position_sizeÂ >Â 0)
Â Â Â Â //Â Â Â Â Â Â Â Â stoplossÂ :=Â calcStopLossPrice(sl)
Â Â Â Â //Â Â Â Â Â Â Â Â takeprofitÂ :=Â tp_l
Â Â Â Â //Â Â Â Â ifÂ (strategy.position_sizeÂ <Â 0)
Â Â Â Â //Â Â Â Â Â Â Â Â stoplossÂ :=Â calcStopLossPrice(sl)
Â Â Â Â //Â Â Â Â Â Â Â Â takeprofitÂ :=Â tp_s
Â Â Â Â //Â Â Â Â elseÂ ifÂ strategy.position_sizeÂ ==Â 0
Â Â Â Â //Â Â Â Â Â Â Â Â stoplossÂ :=Â na
Â Â Â Â //Â Â Â Â Â Â Â Â takeprofitÂ :=Â na
ifÂ modeÂ ==Â true
Â Â Â Â ifÂ SMODEÂ ==Â false
Â Â Â Â Â Â Â Â ifÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â profitÂ =Â takeprofit,Â stopÂ =Â stoploss,Â comment_profitÂ =Â "TPğŸ’šL",Â comment_lossÂ =Â "SLğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Short',Â qty_percentÂ =Â 100,Â profitÂ =Â takeprofit,Â stopÂ =Â stoploss,Â comment_profitÂ =Â "TPâ¤ï¸ï¸S",Â comment_lossÂ =Â "SLâ¤ï¸ï¸S",Â alert_messageÂ =Â Alert_StopLossshort)
Â Â Â Â elseÂ ifÂ SMODEÂ ==Â true
Â Â Â Â Â Â Â Â ifÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.exit("Exit",'Long',Â qty_percentÂ =Â 100Â ,Â profitÂ =Â takeprofit,Â stopÂ =Â stoploss,Â comment_profitÂ =Â "TPğŸ’šL",Â comment_lossÂ =Â "SLğŸ’šL",Â alert_messageÂ =Â Alert_StopLosslong)
ifÂ BOTrail_MODEÂ ==Â true
Â Â Â Â ifÂ SMODEÂ ==Â false
Â Â Â Â Â Â Â Â ifÂ SL_LongBOÂ andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Long",Â qty_percentÂ =Â 100,Â commentÂ =Â "â‡ï¸CALLBACKâ‡ï¸",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â ifÂ SL_ShortBOÂ andÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Short",Â qty_percentÂ =Â 100,Â commentÂ =Â "â‡ï¸CALLBACKâ‡ï¸",Â alert_messageÂ =Â Alert_StopLossshort)
Â Â Â Â 
Â Â Â Â elseÂ ifÂ SMODEÂ ==Â true
Â Â Â Â Â Â Â Â ifÂ SL_LongBOÂ andÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â Â Â Â Â strategy.close("Long",Â qty_percentÂ =Â 100,Â commentÂ =Â "â‡ï¸CALLBACKâ‡ï¸",Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â //ifÂ strategy.position_sizeÂ >Â 0
Â Â Â Â Â Â Â Â //Â Â Â Â strategy.exit("Exit",'Long',Â profitÂ =Â takeprofit,Â whenÂ =Â stoploss,Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â //Â Â strategy.exit("Exit",'Long',Â profitÂ =Â takeprofit,Â stopÂ =Â stoploss,Â alert_messageÂ =Â Alert_StopLosslong)
Â Â Â Â Â Â Â Â //ifÂ strategy.position_sizeÂ <Â 0
Â Â Â Â Â Â Â Â //Â Â Â Â strategy.exit("Exit",'Short',Â profitÂ =Â takeprofit,Â stopÂ =Â stoploss,Â alert_messageÂ =Â Alert_StopLossshort)
////////////////////////////////////////////////////////////////////////////////////////////////////////////////
srccdcÂ =Â input(title='DataÂ Array',Â defval=ohlc4,Â group="BarÂ PaintÂ ColorÂ Red/Blue/Yellow/Green",Â tooltipÂ =Â 'JustÂ BarÂ PaintÂ Only\nNoÂ EffectÂ ForÂ EMA/SMAÂ Line')
APcdcÂ =Â ta.ema(srccdc,Â 2)
////////////////////////////////////////////////////////////////////////////////////////////////////////////////Â 
//Â **************Â BarPaintÂ ***********
BullishÂ =Â price1strategyÂ >Â price3strategy
BearishÂ =Â price1strategyÂ <Â price3strategy
GreenÂ =Â BullishÂ andÂ APcdcÂ >Â price1strategy
RedÂ =Â BearishÂ andÂ APcdcÂ <Â price1strategy
YellowÂ =Â BullishÂ andÂ APcdcÂ <Â price1strategy
BlueÂ =Â BearishÂ andÂ APcdcÂ >Â price1strategy
BuycdcÂ =Â BullishÂ andÂ Bearish[1]
SellcdcÂ =Â BearishÂ andÂ Bullish[1]
//Plot
bcolorÂ =Â GreenÂ ?Â color.limeÂ :Â RedÂ ?Â color.redÂ :Â YellowÂ ?Â color.yellowÂ :Â BlueÂ ?Â color.blueÂ :Â color.white
barcolor(color=bcolor)
//plot(series=price1strategy,Â style=plot.style_line,Â title='1stÂ MA',Â color=color.new(color.yellow,Â 0),Â linewidth=2)
//plot(series=price2strategy,Â style=plot.style_line,Â title='2ndÂ MA',Â color=color.new(color.blue,Â 0),Â linewidth=1)
//plot(series=price3strategy,Â style=plot.style_line,Â title='3rdÂ MA',Â color=color.new(color.red,Â 0),Â linewidth=2)
FastLÂ =Â plot(fastSWÂ ?Â price1strategyÂ :Â na,Â 'FastÂ MA',Â color=color.new(color.red,Â 0),Â styleÂ =Â plot.style_line,Â linewidth=2)
MidLÂ =Â plot(MA2_MODEÂ ?Â price2strategyÂ :Â na,Â 'MiddleÂ MA',Â color=color.new(color.blue,Â 0),Â styleÂ =Â plot.style_line,Â linewidth=2)
SlowLÂ =Â plot(slowSWÂ ?Â price3strategyÂ :Â na,Â 'SlowÂ MA',Â color=color.new(color.yellow,Â 0),Â styleÂ =Â plot.style_line,Â linewidth=2)
fillcolorÂ =Â BullishÂ ?Â color.new(color.green,90)Â :Â BearishÂ ?Â color.new(color.red,90)Â :Â color.new(color.black,90)Â //Â fillcolorÂ =Â BullishÂ ?Â color.greenÂ :Â BearishÂ ?Â color.redÂ :Â color.black
//fill(FastL,Â MidL,Â SlowL,Â fillcolor)Â //Â fill(price1strategy,Â price2strategy,Â price3strategy,Â fillcolor,Â transp=90)
//longCondition2Â =Â ta.crossover(price1strategy,Â price3strategy)
//shortCondition2Â =Â ta.crossunder(price1strategy,Â price2strategy)
//plotshape(longCondition,Â title='buytag',Â text='ğŸŒ™',Â color=color.new(color.green,Â 0),Â style=shape.labelup,Â location=location.belowbar,Â size=size.large,Â textcolor=color.new(color.white,Â 0))Â Â //plotÂ forÂ buyÂ icon
//plotshape(shortCondition,Â title='selltag',Â text='ğŸ‘»',Â color=color.new(color.red,Â 0),Â style=shape.labeldown,Â location=location.abovebar,Â size=size.large,Â textcolor=color.new(color.white,Â 0))Â Â //plotÂ forÂ sellÂ icon
//Â SwingÂ Plot
Swing_MODEÂ =Â input.bool(title="SWINGÂ MODE",Â defval=true,Â groupÂ =Â '=Â SWINGÂ SETTINGÂ =',Â tooltipÂ =Â 'IfÂ ModeÂ OnÂ =Â PlotÂ SwingÂ HighÂ andÂ SwingÂ Low')
pvtLenLÂ =Â input.int(6,Â minval=1,Â title='PivotÂ LengthÂ LeftÂ HandÂ Side',Â groupÂ =Â '=Â SWINGÂ SETTINGÂ =')
pvtLenRÂ =Â input.int(6,Â minval=1,Â title='PivotÂ LengthÂ RightÂ HandÂ Side',Â groupÂ =Â '=Â SWINGÂ SETTINGÂ =')
showStopÂ =Â input(true,Â title='ShowÂ RecentÂ LowÂ Stop?',Â groupÂ =Â '=Â SWINGÂ SETTINGÂ =')
//Â GetÂ HighÂ andÂ LowÂ PivotÂ Points
pvthi_Â =Â ta.pivothigh(high,Â pvtLenL,Â pvtLenR)
pvtlo_Â =Â ta.pivotlow(low,Â pvtLenL,Â pvtLenR)
//Â ForceÂ PivotÂ completionÂ beforeÂ plotting.
ShuntÂ =Â 1Â Â //WaitÂ forÂ closeÂ beforeÂ printingÂ pivot?Â 1Â forÂ trueÂ 0Â forÂ flase
maxLvlLenÂ =Â 0Â Â //MaximumÂ ExtensionÂ Length
pvthiÂ =Â pvthi_[Shunt]
pvtloÂ =Â pvtlo_[Shunt]
//Â CountÂ HowÂ manyÂ candlesÂ forÂ currentÂ PivotÂ Level,Â IfÂ newÂ reset.
counthiÂ =Â ta.barssince(notÂ na(pvthi))
countloÂ =Â ta.barssince(notÂ na(pvtlo))
pvthisÂ =Â fixnan(pvthi)
pvtlosÂ =Â fixnan(pvtlo)
hipcÂ =Â ta.change(pvthis)Â !=Â 0Â ?Â naÂ :Â color.maroon
lopcÂ =Â ta.change(pvtlos)Â !=Â 0Â ?Â naÂ :Â color.green
//Â DisplayÂ PivotÂ lines
plot(Swing_MODEÂ ?Â maxLvlLenÂ ==Â 0Â orÂ counthiÂ <Â maxLvlLenÂ ?Â pvthisÂ :Â naÂ :Â na,Â color=hipc,Â linewidth=1,Â offset=-pvtLenRÂ -Â Shunt,Â title='TopÂ Levels')
plot(Swing_MODEÂ ?Â maxLvlLenÂ ==Â 0Â orÂ countloÂ <Â maxLvlLenÂ ?Â pvtlosÂ :Â naÂ :Â na,Â color=lopc,Â linewidth=1,Â offset=-pvtLenRÂ -Â Shunt,Â title='BottomÂ Levels')
plot(Swing_MODEÂ ?Â maxLvlLenÂ ==Â 0Â orÂ counthiÂ <Â maxLvlLenÂ ?Â pvthisÂ :Â naÂ :Â na,Â color=hipc,Â linewidth=1,Â offset=0,Â title='TopÂ LevelsÂ 2')
plot(Swing_MODEÂ ?Â maxLvlLenÂ ==Â 0Â orÂ countloÂ <Â maxLvlLenÂ ?Â pvtlosÂ :Â naÂ :Â na,Â color=lopc,Â linewidth=1,Â offset=0,Â title='BottomÂ LevelsÂ 2')
//Â StopÂ Levels
stopLevelÂ =Â ta.valuewhen(pvtlo_,Â low[pvtLenR],Â 0)
plotStopLevelÂ =Â showStopÂ ==Â trueÂ ?Â stopLevelÂ :Â na
plot(Swing_MODEÂ Â ?Â plotStopLevelÂ :Â na,Â style=plot.style_linebr,Â color=color.new(color.orange,Â 50),Â show_last=1,Â linewidth=2,Â trackprice=true)
//******************************************
TRAILING_MODEÂ =Â input.bool(title="TRAILINGÂ MODE",Â defval=false,Â groupÂ =Â '=Â TRAILINGÂ TP/SLÂ SETTINGÂ =',Â tooltipÂ =Â 'WhenÂ CandleÂ PriceÂ CloseÂ >Â orÂ <Â TrailingÂ Line\nShouldÂ TPÂ orÂ SLÂ byÂ YourÂ Position')
c480=request.security(syminfo.tickerid,Â "M",Â close,Â barmerge.gaps_off,Â barmerge.lookahead_on)
c4801=request.security(syminfo.tickerid,Â "M",Â close[1],Â barmerge.gaps_off,Â barmerge.lookahead_on)
c4802=request.security(syminfo.tickerid,Â "M",Â close[2],Â barmerge.gaps_off,Â barmerge.lookahead_on)
c4803=request.security(syminfo.tickerid,Â "M",Â close[3],Â barmerge.gaps_off,Â barmerge.lookahead_on)
c4804=request.security(syminfo.tickerid,Â "M",Â close[4],Â barmerge.gaps_off,Â barmerge.lookahead_on)
c4805=request.security(syminfo.tickerid,Â "M",Â close[5],Â barmerge.gaps_off,Â barmerge.lookahead_on)
h480=request.security(syminfo.tickerid,Â "480",Â high,Â barmerge.gaps_off,Â barmerge.lookahead_on)
mc=(c480+c4801+c4802+c4803+c4804)/5
plot(TRAILING_MODEÂ ?Â mcÂ :Â na,Â 'TrailingTP/SL',Â color=color.new(color.lime,0),Â style=plot.style_stepline,Â linewidth=2)
//*********Â BackgroundÂ PaintÂ ***********************
BG_MODEÂ =Â input.bool(title="BACKGROUNDÂ PAINTÂ MODE",Â defval=true,Â groupÂ =Â '=Â BACKGROUNDÂ PAINTÂ SETTINGÂ =',Â tooltipÂ =Â 'JustÂ FillÂ BackgroundÂ ColorÂ andÂ PaintÂ LineÂ BetweenÂ Space')
prefillFastÂ =Â plot(BG_MODEÂ ?Â price1strategyÂ :Â na,Â 'FastÂ MA',Â color=color.new(color.red,Â 100),Â styleÂ =Â plot.style_line,Â linewidth=2)
prefillMidÂ =Â plot(MA2_MODEÂ ?Â BG_MODEÂ ?Â price2strategyÂ :Â naÂ :Â na,Â 'MiddleÂ MA',Â color=color.new(color.blue,Â 100),Â styleÂ =Â plot.style_line,Â linewidth=2)
prefillSlowÂ =Â plot(BG_MODEÂ ?Â price3strategyÂ :Â na,Â 'FastÂ MA',Â color=color.new(color.yellow,Â 100),Â styleÂ =Â plot.style_line,Â linewidth=2)
fcolorÂ =Â price1strategyÂ >Â price3strategyÂ ?Â color.new(color.lime,70)Â :Â color.new(color.blue,70)
fcolor2Â =Â price1strategyÂ >Â price2strategyÂ ?Â color.new(color.lime,70)Â :Â color.new(color.red,70)
fill(prefillFast,prefillSlow,Â color=fcolor,Â title='BACKGROUNDÂ PAINT')
fill(prefillFast,prefillMid,Â color=fcolor2,Â title='BACKGROUNDÂ PAINT')
//Â **********************************************
//à¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰Â Â library
importÂ X4815162342/X48_LibaryStrategyStatus/2Â asÂ fuLiÂ 
//à¹à¸ªà¸”à¸‡à¸œà¸¥Â Backtest
show_NetÂ =Â input.bool(true,'MonitorÂ Profit&Loss',Â inlineÂ =Â 'Lnet',Â groupÂ =Â '=Â PNLÂ MONITORÂ SETTINGÂ =')
position_Â =Â input.string('bottom_center','Position',Â optionsÂ =Â ['top_right','middle_right','bottom_right','top_center','middle_center','bottom_center','middle_left','bottom_left']Â ,Â inlineÂ =Â 'Lnet')
size_iÂ =Â input.string('auto','size',Â optionsÂ =Â ['auto','tiny','small','normal']Â ,Â inlineÂ =Â 'Lnet')Â 
color_NetÂ =Â input.color(color.blue,""Â ,Â inlineÂ =Â 'Lnet')
fuLi.NetProfit_Show(show_NetÂ ,Â position_Â ,Â size_i,Â Â color_NetÂ )
Expand (407 lines)